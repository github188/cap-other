
jsPlumbUtil={isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},isString:function(a){return"string"==typeof a},isBoolean:function(a){return"boolean"==typeof a},isObject:function(a){return"[object Object]"===Object.prototype.toString.call(a)},isDate:function(a){return"[object Date]"===Object.prototype.toString.call(a)},isFunction:function(a){return"[object Function]"===Object.prototype.toString.call(a)},clone:function(a){if(this.isString(a))return new String(a);if(this.isBoolean(a))return new Boolean(a);if(this.isDate(a))return new Date(a.getTime());if(this.isFunction(a))return a;if(this.isArray(a)){for(var b=[],c=0;c<a.length;c++)b.push(this.clone(a[c]));return b}if(this.isObject(a)){var b={};for(var c in a)b[c]=this.clone(a[c]);return b}return a},merge:function(a,b){var c=this.clone(a);for(var d in b)if(null==c[d]||this.isString(b[d])||this.isBoolean(b[d]))c[d]=b[d];else if(this.isArray(b[d])&&this.isArray(c[d])){var e=[];e.push.apply(e,c[d]),e.push.apply(e,b[d]),c[d]=e}else if(this.isObject(c[d])&&this.isObject(b[d]))for(var f in b[d])c[d][f]=b[d][f];return c},convertStyle:function(a,b){if("transparent"===a)return a;var c=a,d=function(a){return 1==a.length?"0"+a:a},e=function(a){return d(Number(a).toString(16))},f=/(rgb[a]?\()(.*)(\))/;if(a.match(f)){var g=a.match(f)[2].split(",");c="#"+e(g[0])+e(g[1])+e(g[2]),b||4!=g.length||(c+=e(g[3]))}return c},gradient:function(a,b){return a=jsPlumbUtil.isArray(a)?a:[a.x,a.y],b=jsPlumbUtil.isArray(b)?b:[b.x,b.y],(b[1]-a[1])/(b[0]-a[0])},normal:function(a,b){return-1/jsPlumbUtil.gradient(a,b)},lineLength:function(a,b){return a=jsPlumbUtil.isArray(a)?a:[a.x,a.y],b=jsPlumbUtil.isArray(b)?b:[b.x,b.y],Math.sqrt(Math.pow(b[1]-a[1],2)+Math.pow(b[0]-a[0],2))},segment:function(a,b){return a=jsPlumbUtil.isArray(a)?a:[a.x,a.y],b=jsPlumbUtil.isArray(b)?b:[b.x,b.y],b[0]>a[0]?b[1]>a[1]?2:1:b[1]>a[1]?3:4},intersects:function(a,b){var c=a.x,d=a.x+a.w,e=a.y,f=a.y+a.h,g=b.x,h=b.x+b.w,i=b.y,j=b.y+b.h;return c<=g&&g<=d&&e<=i&&i<=f||c<=h&&h<=d&&e<=i&&i<=f||c<=g&&g<=d&&e<=j&&j<=f||c<=h&&g<=d&&e<=j&&j<=f||g<=c&&c<=h&&i<=e&&e<=j||g<=d&&d<=h&&i<=e&&e<=j||g<=c&&c<=h&&i<=f&&f<=j||g<=d&&c<=h&&i<=f&&f<=j},segmentMultipliers:[null,[1,-1],[1,1],[-1,1],[-1,-1]],inverseSegmentMultipliers:[null,[-1,-1],[-1,1],[1,1],[1,-1]],pointOnLine:function(a,b,c){var d=jsPlumbUtil.gradient(a,b),e=jsPlumbUtil.segment(a,b),f=c>0?jsPlumbUtil.segmentMultipliers[e]:jsPlumbUtil.inverseSegmentMultipliers[e],g=Math.atan(d),h=Math.abs(c*Math.sin(g))*f[1],i=Math.abs(c*Math.cos(g))*f[0];return{x:a.x+i,y:a.y+h}},perpendicularLineTo:function(a,b,c){var d=jsPlumbUtil.gradient(a,b),e=Math.atan(-1/d),f=c/2*Math.sin(e),g=c/2*Math.cos(e);return[{x:b.x+g,y:b.y+f},{x:b.x-g,y:b.y-f}]},findWithFunction:function(a,b){if(a)for(var c=0;c<a.length;c++)if(b(a[c]))return c;return-1},indexOf:function(a,b){return jsPlumbUtil.findWithFunction(a,function(a){return a==b})},removeWithFunction:function(a,b){var c=jsPlumbUtil.findWithFunction(a,b);return c>-1&&a.splice(c,1),c!=-1},remove:function(a,b){var c=jsPlumbUtil.indexOf(a,b);return c>-1&&a.splice(c,1),c!=-1},addWithFunction:function(a,b,c){jsPlumbUtil.findWithFunction(a,c)==-1&&a.push(b)},addToList:function(a,b,c){var d=a[b];return null==d&&(d=[],a[b]=d),d.push(c),d},EventGenerator:function(){var a={},b=this,c=["ready"];this.bind=function(c,d){return jsPlumbUtil.addToList(a,c,d),b},this.fire=function(d,e,f){if(a[d])for(var g=0;g<a[d].length;g++)if(jsPlumbUtil.findWithFunction(c,function(a){return a===d})!=-1)a[d][g](e,f);else try{a[d][g](e,f)}catch(a){jsPlumbUtil.log("jsPlumb: fire failed for event "+d+" : "+a)}return b},this.unbind=function(c){return c?delete a[c]:a={},b},this.getListener=function(b){return a[b]}},logEnabled:!0,log:function(){if(jsPlumbUtil.logEnabled&&"undefined"!=typeof console)try{arguments[arguments.length-1]}catch(a){}},group:function(a){jsPlumbUtil.logEnabled&&"undefined"!=typeof console&&console.group(a)},groupEnd:function(a){jsPlumbUtil.logEnabled&&"undefined"!=typeof console&&console.groupEnd(a)},time:function(a){jsPlumbUtil.logEnabled&&"undefined"!=typeof console&&console.time(a)},timeEnd:function(a){jsPlumbUtil.logEnabled&&"undefined"!=typeof console&&console.timeEnd(a)}},function(){var a=!!document.createElement("canvas").getContext,b=!!window.SVGAngle||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),c=function(){if(void 0==c.vml){var a=document.body.appendChild(document.createElement("div"));a.innerHTML='<v:shape id="vml_flag1" adj="1" />';var b=a.firstChild;b.style.behavior="url(#default#VML)",c.vml=!b||"object"==typeof b.adj,a.parentNode.removeChild(a)}return c.vml},d=function(a){var b={},c=[],d={},e={};this.register=function(f){var g=jsPlumb.CurrentLibrary;f=g.getElementObject(f);var h=a.getId(f),i=g.getDOMElement(f),j=g.getOffset(f);b[h]||(b[h]=f,c.push(f),d[h]={});var k=function(b,c){if(b)for(var f=0;f<b.childNodes.length;f++)if(3!=b.childNodes[f].nodeType){var i=g.getElementObject(b.childNodes[f]),l=a.getId(i,null,!0);if(l&&e[l]&&e[l]>0){var m=g.getOffset(i);d[h][l]={id:l,offset:{left:m.left-j.left,top:m.top-j.top}}}k(b.childNodes[f])}};k(i)},this.updateOffsets=function(b){var c=jsPlumb.CurrentLibrary,e=c.getElementObject(b),f=a.getId(e),g=d[f],h=c.getOffset(e);if(g)for(var i in g){var j=c.getElementObject(i),k=c.getOffset(j);d[f][i]={id:i,offset:{left:k.left-h.left,top:k.top-h.top}}}},this.endpointAdded=function(c){var f=jsPlumb.CurrentLibrary,g=document.body,h=a.getId(c),i=f.getDOMElement(c),j=i.parentNode;for(e[h]=e[h]?e[h]+1:1;j!=g;){var k=a.getId(j,null,!0);if(k&&b[k]){var l=f.getElementObject(j),m=f.getOffset(l);if(null==d[k][h]){var n=jsPlumb.CurrentLibrary.getOffset(c);d[k][h]={id:h,offset:{left:n.left-m.left,top:n.top-m.top}}}break}j=j.parentNode}},this.endpointDeleted=function(a){if(e[a.elementId]&&(e[a.elementId]--,e[a.elementId]<=0))for(var b in d)delete d[b][a.elementId]},this.getElementsForDraggable=function(a){return d[a]},this.reset=function(){b={},c=[],d={},e={}}};window.console||(window.console={time:function(){},timeEnd:function(){},group:function(){},groupEnd:function(){},log:function(){}}),window.jsPlumbAdapter={headless:!1,appendToRoot:function(a){document.body.appendChild(a)},getRenderModes:function(){return["canvas","svg","vml"]},isRenderModeAvailable:function(d){return{canvas:a,svg:b,vml:c()}[d]},getDragManager:function(a){return new d(a)},setRenderMode:function(a){var b;if(a){a=a.toLowerCase();var c=this.isRenderModeAvailable("canvas"),d=this.isRenderModeAvailable("svg"),e=this.isRenderModeAvailable("vml");"svg"===a?d?b="svg":c?b="canvas":e&&(b="vml"):"canvas"===a&&c?b="canvas":e&&(b="vml")}return b}}}(),function(){var a=jsPlumbUtil.findWithFunction,b=jsPlumbUtil.indexOf,c=jsPlumbUtil.removeWithFunction,d=(jsPlumbUtil.remove,jsPlumbUtil.addWithFunction),e=(jsPlumbUtil.addToList,jsPlumbUtil.isArray),f=jsPlumbUtil.isString,g=jsPlumbUtil.isObject,h=null,i=function(a,b){return x.CurrentLibrary.getAttribute(m(a),b)},j=function(a,b,c){x.CurrentLibrary.setAttribute(m(a),b,c)},k=function(a,b){x.CurrentLibrary.addClass(m(a),b)},l=function(a,b){x.CurrentLibrary.removeClass(m(a),b)},m=function(a){return x.CurrentLibrary.getElementObject(a)},n=function(a,b){var c=x.CurrentLibrary.getOffset(m(a));if(null!=b){var d=b.getZoom();return{left:c.left/d,top:c.top/d}}return c},o=function(a){return x.CurrentLibrary.getSize(m(a))},p=jsPlumbUtil.log,q=(jsPlumbUtil.group,jsPlumbUtil.groupEnd,jsPlumbUtil.time,jsPlumbUtil.timeEnd,function(){return""+(new Date).getTime()}),r=function(a){var b=this,c=arguments,d=!1,e=a.parameters||{},f=b.idPrefix,g=f+(new Date).getTime(),h=null,i=null;b._jsPlumb=a._jsPlumb,b.getId=function(){return g},b.tooltip=a.tooltip,b.hoverClass=a.hoverClass||b._jsPlumb.Defaults.HoverClass||x.Defaults.HoverClass,jsPlumbUtil.EventGenerator.apply(this),this.clone=function(){var a=new Object;return b.constructor.apply(a,c),a},this.getParameter=function(a){return e[a]},this.getParameters=function(){return e},this.setParameter=function(a,b){e[a]=b},this.setParameters=function(a){e=a},this.overlayPlacements=[];var j=a.beforeDetach;this.isDetachAllowed=function(a){var c=b._jsPlumb.checkCondition("beforeDetach",a);if(j)try{c=j(a)}catch(a){p("jsPlumb: beforeDetach callback failed",a)}return c};var k=a.beforeDrop;this.isDropAllowed=function(a,c,d,e,f){var g=b._jsPlumb.checkCondition("beforeDrop",{sourceId:a,targetId:c,scope:d,connection:e,dropEndpoint:f});if(k)try{g=k({sourceId:a,targetId:c,scope:d,connection:e,dropEndpoint:f})}catch(a){p("jsPlumb: beforeDrop callback failed",a)}return g};var l=function(){if(h&&i){var a={};x.extend(a,h),x.extend(a,i),delete b.hoverPaintStyle,a.gradient&&h.fillStyle&&delete a.gradient,i=a}};this.setPaintStyle=function(a,c){h=a,b.paintStyleInUse=h,l(),c||b.repaint()},this.getPaintStyle=function(){return h},this.setHoverPaintStyle=function(a,c){i=a,l(),c||b.repaint()},this.getHoverPaintStyle=function(){return i},this.setHover=function(a,c,e){b._jsPlumb.currentlyDragging||b._jsPlumb.isHoverSuspended()||(d=a,null!=b.hoverClass&&null!=b.canvas&&(a?n.addClass(b.canvas,b.hoverClass):n.removeClass(b.canvas,b.hoverClass)),null!=i&&(b.paintStyleInUse=a?i:h,e=e||q(),b.repaint({timestamp:e,recalc:!1})),b.getAttachedElements&&!c&&u(a,q(),b))},this.isHover=function(){return d};var m=null;this.setZIndex=function(a){m=a},this.getZIndex=function(){return m};var n=x.CurrentLibrary,o=["click","dblclick","mouseenter","mouseout","mousemove","mousedown","mouseup","contextmenu"],r={mouseout:"mouseexit"},s=function(a,b,c){var d=r[c]||c;n.bind(a,c,function(a){b.fire(d,b,a)})},t=function(a,b){r[b]||b;n.unbind(a,b)};this.attachListeners=function(a,b){for(var c=0;c<o.length;c++)s(a,b,o[c])};var u=function(a,c,d){var e=b.getAttachedElements();if(e)for(var f=0;f<e.length;f++)d&&d==e[f]||e[f].setHover(a,!0,c)};this.reattachListenersForElement=function(a){if(arguments.length>1){for(var c=0;c<o.length;c++)t(a,o[c]);for(var c=1;c<arguments.length;c++)b.attachListeners(a,arguments[c])}};var v=[],w=function(a){return null==a?null:a.split(" ")},y=function(a){if(b.getDefaultType){for(var c=b.getTypeDescriptor(),d=jsPlumbUtil.merge({},b.getDefaultType()),e=0;e<v.length;e++)d=jsPlumbUtil.merge(d,b._jsPlumb.getType(v[e],c));b.applyType(d),a||b.repaint()}};b.setType=function(a,b){v=w(a)||[],y(b)},b.getType=function(){return v},b.hasType=function(a){return jsPlumbUtil.indexOf(v,a)!=-1},b.addType=function(a,c){var d=w(a),e=!1;if(null!=d){for(var f=0;f<d.length;f++)b.hasType(d[f])||(v.push(d[f]),e=!0);e&&y(c)}},b.removeType=function(a,b){var c=w(a),d=!1,e=function(a){var b=jsPlumbUtil.indexOf(v,a);return b!=-1&&(v.splice(b,1),!0)};if(null!=c){for(var f=0;f<c.length;f++)d=e(c[f])||d;d&&y(b)}},b.toggleType=function(a,b){var c=w(a);if(null!=c){for(var d=0;d<c.length;d++){var e=jsPlumbUtil.indexOf(v,c[d]);e!=-1?v.splice(e,1):v.push(c[d])}y(b)}},this.applyType=function(a){if(b.setPaintStyle(a.paintStyle),b.setHoverPaintStyle(a.hoverPaintStyle),a.parameters)for(var c in a.parameters)b.setParameter(c,a.parameters[c])}},s=function(a){r.apply(this,arguments);var b=this;this.overlays=[];var c=function(a){var c=null;if(e(a)){var d=a[0],f=x.extend({component:b,_jsPlumb:b._jsPlumb},a[1]);if(3==a.length&&x.extend(f,a[2]),c=new(x.Overlays[b._jsPlumb.getRenderMode()][d])(f),f.events)for(var g in f.events)c.bind(g,f.events[g])}else c=a.constructor==String?new(x.Overlays[b._jsPlumb.getRenderMode()][a])({component:b,_jsPlumb:b._jsPlumb}):a;b.overlays.push(c)},d=function(a){var c=b.defaultOverlayKeys||[],d=a.overlays,e=function(a){return b._jsPlumb.Defaults[a]||x.Defaults[a]||[]};d||(d=[]);for(var f=0;f<c.length;f++)d.unshift.apply(d,e(c[f]));return d},f=d(a);if(f)for(var g=0;g<f.length;g++)c(f[g]);var h=function(a){for(var c=-1,d=0;d<b.overlays.length;d++)if(a===b.overlays[d].id){c=d;break}return c};this.addOverlay=function(a,d){c(a),d||b.repaint()},this.getOverlay=function(a){var c=h(a);return c>=0?b.overlays[c]:null},this.getOverlays=function(){return b.overlays},this.hideOverlay=function(a){var c=b.getOverlay(a);c&&c.hide()},this.hideOverlays=function(){for(var a=0;a<b.overlays.length;a++)b.overlays[a].hide()},this.showOverlay=function(a){var c=b.getOverlay(a);c&&c.show()},this.showOverlays=function(){for(var a=0;a<b.overlays.length;a++)b.overlays[a].show()},this.removeAllOverlays=function(){for(var a=0;a<b.overlays.length;a++)b.overlays[a].cleanup&&b.overlays[a].cleanup();b.overlays.splice(0,b.overlays.length),b.repaint()},this.removeOverlay=function(a){var c=h(a);if(c!=-1){var d=b.overlays[c];d.cleanup&&d.cleanup(),b.overlays.splice(c,1)}},this.removeOverlays=function(){for(var a=0;a<arguments.length;a++)b.removeOverlay(arguments[a])};var i="__label",j=function(a){var c={cssClass:a.cssClass,labelStyle:this.labelStyle,id:i,component:b,_jsPlumb:b._jsPlumb},d=x.extend(c,a);return new(x.Overlays[b._jsPlumb.getRenderMode()].Label)(d)};if(a.label){var k=a.labelLocation||b.defaultLabelLocation||.5,l=a.labelStyle||b._jsPlumb.Defaults.LabelStyle||x.Defaults.LabelStyle;this.overlays.push(j({label:a.label,location:k,labelStyle:l}))}this.setLabel=function(a){var c=b.getOverlay(i);if(c)a.constructor==String||a.constructor==Function?c.setLabel(a):(a.label&&c.setLabel(a.label),a.location&&c.setLocation(a.location));else{var d=a.constructor==String||a.constructor==Function?{label:a}:a;c=j(d),this.overlays.push(c)}b._jsPlumb.isSuspendDrawing()||b.repaint()},this.getLabel=function(){var a=b.getOverlay(i);return null!=a?a.getLabel():null},this.getLabelOverlay=function(){return b.getOverlay(i)};var m=this.applyType;this.applyType=function(a){if(m(a),b.removeAllOverlays(),a.overlays)for(var c=0;c<a.overlays.length;c++)b.addOverlay(a.overlays[c],!0)}},t=function(a,b,c){a.bind("click",function(a,c){b.fire("click",b,c)}),a.bind("dblclick",function(a,c){b.fire("dblclick",b,c)}),a.bind("contextmenu",function(a,c){b.fire("contextmenu",b,c)}),a.bind("mouseenter",function(a,d){b.isHover()||(c(!0),b.fire("mouseenter",b,d))}),a.bind("mouseexit",function(a,d){b.isHover()&&(c(!1),b.fire("mouseexit",b,d))})},u=0,v=function(){var a=u+1;return u++,a},w=function(u){this.Defaults={Anchor:"BottomCenter",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",ConnectorZIndex:null,Container:null,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fillStyle:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{lineWidth:8,strokeStyle:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"},u&&x.extend(this.Defaults,u),this.logEnabled=this.Defaults.LogEnabled;var w={},y={};this.registerConnectionType=function(a,b){w[a]=x.extend({},b)},this.registerConnectionTypes=function(a){for(var b in a)w[b]=x.extend({},a[b])},this.registerEndpointType=function(a,b){y[a]=x.extend({},b)},this.registerEndpointTypes=function(a){for(var b in a)y[b]=x.extend({},a[b])},this.getType=function(a,b){return"connection"===b?w[a]:y[a]},jsPlumbUtil.EventGenerator.apply(this);var z=this,A=v(),B=z.bind,C={},D=1;this.setZoom=function(a,b){D=a,b&&z.repaintEverything()},this.getZoom=function(){return D};for(var E in this.Defaults)C[E]=this.Defaults[E];this.bind=function(a,b){"ready"===a&&G?b():B.apply(z,[a,b])},z.importDefaults=function(a){for(var b in a)z.Defaults[b]=a[b]},z.restoreDefaults=function(){z.Defaults=x.extend({},C)};var F=null,G=!1,H={},I={},J={},K={},L={},M={},N={},O=[],P=this.Defaults.Scope,Q=null,R=function(a,b,c){var d=a[b];return null==d&&(d=[],a[b]=d),d.push(c),d},S=function(a,b){z.Defaults.Container?x.CurrentLibrary.appendElement(a,z.Defaults.Container):b?x.CurrentLibrary.appendElement(a,b):jsPlumbAdapter.appendToRoot(a)},T=1,U=function(){return""+T++},V=function(a){return a._nodes?a._nodes:a},W=function(a,b,c){if(!jsPlumbAdapter.headless&&!Va){var d=i(a,"id"),e=z.dragManager.getElementsForDraggable(d);if(null==c&&(c=q()),z.anchorManager.redraw(d,b,c),e)for(var f in e)z.anchorManager.redraw(e[f].id,b,c,e[f].offset);var g=m(a);if(g.attr("class").indexOf("lzemay_wModeS")>0&&g.attr("class").indexOf("draggable-dragging")>0){var h=(Math.floor(g.position().left),Math.floor(g.position().top+g.height()/2));$(".c-center .lzemay_wModeS").each(function(a,b){if(d!=this.id&&Math.floor($(this).position().top+$(this).height()/2)+20>h&&Math.floor($(this).position().top+$(this).height()/2)-20<h){var c=$(this).position().top,e=$("#c-center").closest(".bl_box_center")[0].scrollTop+$("#main-center").closest(".bl_box_center")[0].scrollTop,f=$("#demo_emdrap").offset().top;return $("#postionconfirey").css("top",c+f),$("#"+d).attr("type")==$(this).attr("type")||$("#"+d).hasClass("component")&&$(this).hasClass("component")?$("#"+d).css("top",c+e+f):$("#"+d).hasClass("component")&&"BASIC"==$(this).attr("type")?$("#"+d).css("top",c+e+f-21.5):$("#"+d).css("top",c+e+f+21.5),!1}})}}},X=function(a,b){var c=null;if(e(a)){c=[];for(var d=0;d<a.length;d++){var f=m(a[d]),g=i(f,"id");c.push(b(f,g))}}else{var f=m(a),g=i(f,"id");c=b(f,g)}return c},Y=function(a){return J[a]},Z=function(a,b,c){if(!jsPlumbAdapter.headless){var d=null!=b&&b,e=x.CurrentLibrary;if(d&&e.isDragSupported(a)&&!e.isAlreadyDraggable(a)){var f=c||z.Defaults.DragOptions||x.Defaults.DragOptions;f=x.extend({},f);var g=e.dragEvents.drag,h=e.dragEvents.stop,i=e.dragEvents.start;f[i]=pa(f[i],function(){z.setHoverSuspended(!0)}),f[g]=pa(f[g],function(){var b=e.getUIPosition(arguments,z.getZoom());W(a,b),k(a,"jsPlumb_dragged")}),f[h]=pa(f[h],function(){var b=e.getUIPosition(arguments,z.getZoom());W(a,b),l(a,"jsPlumb_dragged"),z.setHoverSuspended(!1),x.repaint(a),Config.DraggableDrapDiv(null,null,m(a)[0],null),$("#postionconfirex").hide(),$("#postionconfirey").hide()});var j=oa(a);N[j]=!0;var d=N[j];f.disabled=null!=d&&!d,e.initDraggable(a,f,!1),z.dragManager.register(a)}}},_=function(a,b){var c=x.extend({sourceIsNew:!0,targetIsNew:!0},a);if(b&&x.extend(c,b),c.source&&c.source.endpoint&&(c.sourceEndpoint=c.source),c.source&&c.target.endpoint&&(c.targetEndpoint=c.target),a.uuids&&(c.sourceEndpoint=Y(a.uuids[0]),c.targetEndpoint=Y(a.uuids[1])),c.sourceEndpoint&&c.sourceEndpoint.isFull())return void p(z,"could not add connection; source endpoint is full");if(c.targetEndpoint&&c.targetEndpoint.isFull())return void p(z,"could not add connection; target endpoint is full");if(c.sourceEndpoint&&(c.sourceIsNew=!1),c.targetEndpoint&&(c.targetIsNew=!1),!c.type&&c.sourceEndpoint&&(c.type=c.sourceEndpoint.connectionType),c.sourceEndpoint&&c.sourceEndpoint.connectorOverlays){c.overlays=c.overlays||[];for(var d=0;d<c.sourceEndpoint.connectorOverlays.length;d++)c.overlays.push(c.sourceEndpoint.connectorOverlays[d])}if(c.tooltip=a.tooltip,!c.tooltip&&c.sourceEndpoint&&c.sourceEndpoint.connectorTooltip&&(c.tooltip=c.sourceEndpoint.connectorTooltip),c.target&&!c.target.endpoint&&!c.targetEndpoint&&!c.newConnection){var e=oa(c.target),f=Ga[e],g=Ha[e];if(f){if(!Ra[e])return;var h=null!=g?g:z.addEndpoint(c.target,f);Ia[e]&&(Ha[e]=h),c.targetEndpoint=h,h._makeTargetCreator=!0,c.targetIsNew=!0}}if(c.source&&!c.source.endpoint&&!c.sourceEndpoint&&!c.newConnection){var e=oa(c.source),f=La[e],g=Ma[e];if(f){if(!Oa[e])return;var h=null!=g?g:z.addEndpoint(c.source,f);Na[e]&&(Ma[e]=h),c.sourceEndpoint=h,c.sourceIsNew=!0}}return c},aa=function(a){var b=z.Defaults.ConnectionType||z.getDefaultConnectionType(),c=z.Defaults.EndpointType||qb,d=x.CurrentLibrary.getParent;a.container?a.parent=a.container:a.sourceEndpoint?a.parent=a.sourceEndpoint.parent:a.source.constructor==c?a.parent=a.source.parent:a.parent=d(a.source),a._jsPlumb=z;var e=new b(a);return e.id="con_"+U(),ca("click","click",e),ca("dblclick","dblclick",e),ca("contextmenu","contextmenu",e),e},ba=function(a,b,c){if(b=b||{},a.suspendedEndpoint||R(H,a.scope,a),!b.doNotFireConnectionEvent&&b.fireEvent!==!1){var d={connection:a,source:a.source,target:a.target,sourceId:a.sourceId,targetId:a.targetId,sourceEndpoint:a.endpoints[0],targetEndpoint:a.endpoints[1]};z.fire("jsPlumbConnection",d,c),z.fire("connection",d,c)}z.anchorManager.newConnection(a),W(a.source)},ca=function(a,b,c){c.bind(a,function(a,d){z.fire(b,c,d)})},da=function(a){if(a.container)return a.container;var b=x.CurrentLibrary.getTagName(a.source),c=x.CurrentLibrary.getParent(a.source);return b&&"td"===b.toLowerCase()?x.CurrentLibrary.getParent(c):c},ea=function(a){var b=z.Defaults.EndpointType||qb;a.parent=da(a),a._jsPlumb=z;var c=new b(a);return c.id="ep_"+U(),ca("click","endpointClick",c),ca("dblclick","endpointDblClick",c),ca("contextmenu","contextmenu",c),jsPlumbAdapter.headless||z.dragManager.endpointAdded(a.source),c},fa=function(a,b,c){var d=I[a];if(d&&d.length)for(var e=0;e<d.length;e++){for(var f=0;f<d[e].connections.length;f++){var g=b(d[e].connections[f]);if(g)return}c&&c(d[e])}},ga=function(a,b){null!=a&&null!=a.parentNode&&a.parentNode.removeChild(a)},ha=function(a,b){for(var c=0;c<a.length;c++)ga(a[c],b)},ia=function(a,b){return X(a,function(a,c){N[c]=b,x.CurrentLibrary.isDragSupported(a)&&x.CurrentLibrary.setDraggable(a,b)})},ja=function(a,b,c){b="block"===b;var d=null;c&&(d=b?function(a){a.setVisible(!0,!0,!0)}:function(a){a.setVisible(!1,!0,!0)});var e=i(a,"id");fa(e,function(a){if(b&&c){var d=a.sourceId===e?1:0;a.endpoints[d].isVisible()&&a.setVisible(!0)}else a.setVisible(b)},d)},ka=function(a){return X(a,function(a,b){var c=null!=N[b]&&N[b];return c=!c,N[b]=c,x.CurrentLibrary.setDraggable(a,c),c})},la=function(a,b){var c=null;b&&(c=function(a){var b=a.isVisible();a.setVisible(!b)}),fa(a,function(a){var b=a.isVisible();a.setVisible(!b)},c)},ma=function(a){var b=a.timestamp,c=a.recalc,d=a.offset,e=a.elId;if(Va&&!b&&(b=Wa),!c&&b&&b===L[e])return K[e];if(c||!d){var f=m(e);null!=f&&(O[e]=o(f),K[e]=n(f,z),L[e]=b)}else if(K[e]=d,null==O[e]){var f=m(e);null!=f&&(O[e]=o(f))}return K[e]&&!K[e].right&&(K[e].right=K[e].left+O[e][0],K[e].bottom=K[e].top+O[e][1],K[e].width=O[e][0],K[e].height=O[e][1],K[e].centerx=K[e].left+K[e].width/2,K[e].centery=K[e].top+K[e].height/2),K[e]},na=function(a){var b=K[a];return b||(b=ma({elId:a})),{o:b,s:O[a]}},oa=function(a,b,c){var d=m(a),e=i(d,"id");return e&&"undefined"!=e||(2==arguments.length&&void 0!=arguments[1]?e=b:(1==arguments.length||3==arguments.length&&!arguments[2])&&(e="jsPlumb_"+A+"_"+U()),c||j(d,"id",e)),e},pa=function(a,b,c){return a=a||function(){},b=b||function(){},function(){var d=null;try{d=b.apply(this,arguments)}catch(a){p(z,"jsPlumb function failed : "+a)}if(null==c||d!==c)try{a.apply(this,arguments)}catch(a){p(z,"wrapped function failed : "+a)}return d}};this.connectorClass="_jsPlumb_connector",this.endpointClass="_jsPlumb_endpoint",this.overlayClass="_jsPlumb_overlay",this.Anchors={},this.Connectors={canvas:{},svg:{},vml:{}},this.Endpoints={canvas:{},svg:{},vml:{}},this.Overlays={canvas:{},svg:{},vml:{}},this.addClass=function(a,b){return x.CurrentLibrary.addClass(a,b)},this.removeClass=function(a,b){return x.CurrentLibrary.removeClass(a,b)},this.hasClass=function(a,b){return x.CurrentLibrary.hasClass(a,b)},this.addEndpoint=function(a,b,c){c=c||{};var d=x.extend({},c);x.extend(d,b),d.endpoint=d.endpoint||z.Defaults.Endpoint||x.Defaults.Endpoint,d.paintStyle=d.paintStyle||z.Defaults.EndpointStyle||x.Defaults.EndpointStyle,a=V(a);for(var e=[],f=a.length&&a.constructor!=String?a:[a],g=0;g<f.length;g++){var h=m(f[g]),i=oa(h);d.source=h,ma({elId:i,timestamp:Wa});var j=ea(d);d.parentAnchor&&(j.parentAnchor=d.parentAnchor),R(I,i,j);var k=K[i],l=O[i],n=j.anchor.compute({xy:[k.left,k.top],wh:l,element:j,timestamp:Wa}),o={anchorLoc:n,timestamp:Wa};Va&&(o.recalc=!1),j.paint(o),e.push(j)}return 1==e.length?e[0]:e},this.addEndpoints=function(a,b,c){for(var d=[],f=0;f<b.length;f++){var g=z.addEndpoint(a,b[f],c);e(g)?Array.prototype.push.apply(d,g):d.push(g)}return d},this.animate=function(a,b,c){var d=m(a),e=i(a,"id");c=c||{};var f=x.CurrentLibrary.dragEvents.step,g=x.CurrentLibrary.dragEvents.complete;c[f]=pa(c[f],function(){z.repaint(e)}),c[g]=pa(c[g],function(){z.repaint(e)}),x.CurrentLibrary.animate(d,b,c)},this.checkCondition=function(a,b){var c=z.getListener(a),d=!0;if(c&&c.length>0)try{for(var e=0;e<c.length;e++)d=d&&c[e](b)}catch(b){p(z,"cannot check condition ["+a+"]"+b)}return d},this.checkASyncCondition=function(a,b,c,d){var e=z.getListener(a);if(e&&e.length>0)try{e[0](b,c,d)}catch(b){p(z,"cannot asynchronously check condition ["+a+"]"+b)}},this.connect=function(a,b){var c,d=_(a,b);return d&&(null==d.deleteEndpointsOnDetach&&(d.deleteEndpointsOnDetach=!0),c=aa(d),ba(c,d)),c},this.deleteEndpoint=function(a){var b="string"==typeof a?J[a]:a;if(b){var c=b.getUuid();c&&(J[c]=null),b.detachAll(),b.endpoint.cleanup&&b.endpoint.cleanup(),ha(b.endpoint.getDisplayElements()),z.anchorManager.deleteEndpoint(b);for(var d in I){var e=I[d];if(e){for(var f=[],g=0;g<e.length;g++)e[g]!=b&&f.push(e[g]);I[d]=f}}jsPlumbAdapter.headless||z.dragManager.endpointDeleted(b)}},this.deleteEveryEndpoint=function(){z.setSuspendDrawing(!0);for(var a in I){var b=I[a];if(b&&b.length)for(var c=0;c<b.length;c++)z.deleteEndpoint(b[c])}I={},J={},z.setSuspendDrawing(!1,!0)};var qa=function(a,b,c){var d=z.Defaults.ConnectionType||z.getDefaultConnectionType(),e=a.constructor==d,f=e?{connection:a,source:a.source,target:a.target,sourceId:a.sourceId,targetId:a.targetId,sourceEndpoint:a.endpoints[0],targetEndpoint:a.endpoints[1]}:a;b&&(z.fire("jsPlumbConnectionDetached",f,c),z.fire("connectionDetached",f,c)),z.anchorManager.connectionDetached(f)},ra=function(a){z.fire("connectionDrag",a)},sa=function(a){z.fire("connectionDragStop",a)};this.detach=function(){if(0!=arguments.length){var a=z.Defaults.ConnectionType||z.getDefaultConnectionType(),b=arguments[0].constructor==a,c=2==arguments.length&&b?arguments[1]||{}:arguments[0],d=c.fireEvent!==!1,e=c.forceDetach,f=b?arguments[0]:c.connection;if(f)(e||f.isDetachAllowed(f)&&f.endpoints[0].isDetachAllowed(f)&&f.endpoints[1].isDetachAllowed(f))&&(e||z.checkCondition("beforeDetach",f))&&f.endpoints[0].detach(f,!1,!0,d);else{var g=x.extend({},c);if(g.uuids)Y(g.uuids[0]).detachFrom(Y(g.uuids[1]),d);else if(g.sourceEndpoint&&g.targetEndpoint)g.sourceEndpoint.detachFrom(g.targetEndpoint);else{var h=oa(g.source),i=oa(g.target);fa(h,function(a){(a.sourceId==h&&a.targetId==i||a.targetId==h&&a.sourceId==i)&&z.checkCondition("beforeDetach",a)&&a.endpoints[0].detach(a,!1,!0,d)})}}}},this.detachAllConnections=function(a,b){b=b||{},a=m(a);var c=i(a,"id"),d=I[c];if(d&&d.length)for(var e=0;e<d.length;e++)d[e].detachAll(b.fireEvent)},this.detachEveryConnection=function(a){a=a||{};for(var b in I){var c=I[b];if(c&&c.length)for(var d=0;d<c.length;d++)c[d].detachAll(a.fireEvent)}H={}},this.draggable=function(a,b){if("object"==typeof a&&a.length)for(var c=0;c<a.length;c++){var d=m(a[c]);d&&Z(d,!0,b)}else if(a._nodes)for(var c=0;c<a._nodes.length;c++){var d=m(a._nodes[c]);d&&Z(d,!0,b)}else{var d=m(a);d&&Z(d,!0,b)}},this.extend=function(a,b){return x.CurrentLibrary.extend(a,b)},this.getDefaultEndpointType=function(){return qb},this.getDefaultConnectionType=function(){return mb};var ta=function(a,b,c,d){for(var e=0;e<a.length;e++)a[e][b].apply(a[e],c);return d(a)},ua=function(a,b,c){for(var d=[],e=0;e<a.length;e++)d.push([a[e][b].apply(a[e],c),a[e]]);return d},va=function(a,b,c){return function(){return ta(a,b,arguments,c)}},wa=function(a,b){return function(){return ua(a,b,arguments)}},xa=function(a,b){var c=[];if(a)if("string"==typeof a){if("*"===a)return a;c.push(a)}else if(b)c=a;else for(var d=0;d<a.length;d++)c.push(oa(m(a[d])));return c},ya=function(a,c,d){return"*"===a||(a.length>0?b(a,c)!=-1:!d)};this.getConnections=function(a,b){a?a.constructor==String&&(a={scope:a}):a={};var c=a.scope||z.getDefaultScope(),d=xa(c,!0),e=xa(a.source),f=xa(a.target),g=!b&&d.length>1?{}:[],h=function(a,c){if(!b&&d.length>1){var e=g[a];null==e&&(e=[],g[a]=e),e.push(c)}else g.push(c)};for(var i in H)if(ya(d,i))for(var j=0;j<H[i].length;j++){var k=H[i][j];ya(e,k.sourceId)&&ya(f,k.targetId)&&h(i,k)}return g};var za=function(a,b){return function(c){for(var d=0;d<a.length;d++)c(a[d]);return b(a)}},Aa=function(a){return function(b){return a[b]}},Ba=function(a,b){return{setHover:va(a,"setHover",b),removeAllOverlays:va(a,"removeAllOverlays",b),setLabel:va(a,"setLabel",b),addOverlay:va(a,"addOverlay",b),removeOverlay:va(a,"removeOverlay",b),removeOverlays:va(a,"removeOverlays",b),showOverlay:va(a,"showOverlay",b),hideOverlay:va(a,"hideOverlay",b),showOverlays:va(a,"showOverlays",b),hideOverlays:va(a,"hideOverlays",b),setPaintStyle:va(a,"setPaintStyle",b),setHoverPaintStyle:va(a,"setHoverPaintStyle",b),setParameter:va(a,"setParameter",b),setParameters:va(a,"setParameters",b),setVisible:va(a,"setVisible",b),setZIndex:va(a,"setZIndex",b),repaint:va(a,"repaint",b),addType:va(a,"addType",b),toggleType:va(a,"toggleType",b),removeType:va(a,"removeType",b),getLabel:wa(a,"getLabel"),getOverlay:wa(a,"getOverlay"),isHover:wa(a,"isHover"),getParameter:wa(a,"getParameter"),getParameters:wa(a,"getParameters"),getPaintStyle:wa(a,"getPaintStyle"),getHoverPaintStyle:wa(a,"getHoverPaintStyle"),isVisible:wa(a,"isVisible"),getZIndex:wa(a,"getZIndex"),hasType:wa(a,"hasType"),getType:wa(a,"getType"),length:a.length,each:za(a,b),get:Aa(a)}},Ca=function(a){var b=Ba(a,Ca);return x.CurrentLibrary.extend(b,{setDetachable:va(a,"setDetachable",Ca),setReattach:va(a,"setReattach",Ca),setConnector:va(a,"setConnector",Ca),detach:function(){for(var b=0;b<a.length;b++)z.detach(a[b])},isDetachable:wa(a,"isDetachable"),isReattach:wa(a,"isReattach")})},Da=function(a){var b=Ba(a,Da);return x.CurrentLibrary.extend(b,{setEnabled:va(a,"setEnabled",Da),isEnabled:wa(a,"isEnabled"),detachAll:function(){for(var b=0;b<a.length;b++)a[b].detachAll()},delete:function(){for(var b=0;b<a.length;b++)z.deleteEndpoint(a[b])}})};this.select=function(a){a=a||{},a.scope=a.scope||"*";var b=z.getConnections(a,!0);return Ca(b)},this.selectEndpoints=function(a){a=a||{},a.scope=a.scope||"*";var b=!a.element&&!a.source&&!a.target,c=b?"*":xa(a.element),d=b?"*":xa(a.source),e=b?"*":xa(a.target),f=xa(a.scope,!0),g=[];for(var h in I){var i=ya(c,h,!0),j=ya(d,h,!0),k="*"!=d,l=ya(e,h,!0),m="*"!=e;if(i||j||l)a:for(var n=0;n<I[h].length;n++){var o=I[h][n];if(ya(f,o.scope,!0)){var p=k&&d.length>0&&!o.isSource,q=m&&e.length>0&&!o.isTarget;if(p||q)continue a;g.push(o)}}}return Da(g)},this.getAllConnections=function(){return H},this.getDefaultScope=function(){return P},this.getEndpoint=Y,this.getEndpoints=function(a){return I[oa(a)]},this.getId=oa,this.getOffset=function(a){K[a];return ma({elId:a})},this.getSelector=function(a){return x.CurrentLibrary.getSelector(a)},this.getSize=function(a){var b=O[a];return b||ma({elId:a}),O[a]},this.appendElement=S;var Ea=!1;this.isHoverSuspended=function(){return Ea},this.setHoverSuspended=function(a){Ea=a};var Fa=function(a){return function(){return jsPlumbAdapter.isRenderModeAvailable(a)}};this.isCanvasAvailable=Fa("canvas"),this.isSVGAvailable=Fa("svg"),this.isVMLAvailable=Fa("vml"),this.hide=function(a,b){ja(a,"none",b)},this.idstamp=U,this.init=function(){if(!G){z.setRenderMode(z.Defaults.RenderMode);var a=function(a){x.CurrentLibrary.bind(document,a,function(b){if(!z.currentlyDragging&&Q==x.CANVAS){for(var c in H)for(var d=H[c],e=0;e<d.length;e++){var f=d[e].connector[a](b);if(f)return}for(var g in I)for(var h=I[g],e=0;e<h.length;e++)if(h[e].endpoint[a](b))return}})};a("click"),a("dblclick"),a("mousemove"),a("mousedown"),a("mouseup"),a("contextmenu"),G=!0,z.fire("ready")}},this.log=F,this.jsPlumbUIComponent=r,this.makeAnchor=function(){if(0==arguments.length)return null;var a=arguments[0],b=arguments[1],c=(arguments[2],null);if(a.compute&&a.getOrientation)return a;if("string"==typeof a)c=x.Anchors[arguments[0]]({elementId:b,jsPlumbInstance:z});else if(e(a))if(e(a[0])||f(a[0]))if(2==a.length&&f(a[0])&&g(a[1])){var d=x.extend({elementId:b,jsPlumbInstance:z},a[1]);c=x.Anchors[a[0]](d)}else c=new $a(a,null,b);else{
var h={x:a[0],y:a[1],orientation:a.length>=4?[a[2],a[3]]:[0,0],offsets:6==a.length?[a[4],a[5]]:[0,0],elementId:b};c=new Ya(h),c.clone=function(){return new Ya(h)}}return c.id||(c.id="anchor_"+U()),c},this.makeAnchors=function(a,b,c){for(var d=[],f=0;f<a.length;f++)"string"==typeof a[f]?d.push(x.Anchors[a[f]]({elementId:b,jsPlumbInstance:c})):e(a[f])&&d.push(z.makeAnchor(a[f],b,c));return d},this.makeDynamicAnchor=function(a,b){return new $a(a,b)};var Ga={},Ha={},Ia={},Ja={},Ka=function(a,b){a.paintStyle=a.paintStyle||z.Defaults.EndpointStyles[b]||z.Defaults.EndpointStyle||x.Defaults.EndpointStyles[b]||x.Defaults.EndpointStyle,a.hoverPaintStyle=a.hoverPaintStyle||z.Defaults.EndpointHoverStyles[b]||z.Defaults.EndpointHoverStyle||x.Defaults.EndpointHoverStyles[b]||x.Defaults.EndpointHoverStyle,a.anchor=a.anchor||z.Defaults.Anchors[b]||z.Defaults.Anchor||x.Defaults.Anchors[b]||x.Defaults.Anchor,a.endpoint=a.endpoint||z.Defaults.Endpoints[b]||z.Defaults.Endpoint||x.Defaults.Endpoints[b]||x.Defaults.Endpoint};this.makeTarget=function(a,b,c){var d=x.extend({_jsPlumb:z},c);x.extend(d,b),Ka(d,1);var e=x.CurrentLibrary,f=d.scope||z.Defaults.Scope,g=!(d.deleteEndpointsOnDetach===!1),h=d.maxConnections||-1,j=d.onMaxConnections;_doOne=function(a){var b=oa(a);Ga[b]=d,Ia[b]=d.uniqueEndpoint,Ja[b]=h,Ra[b]=!0,proxyComponent=new r(d);var c=x.extend({},d.dropOptions||{}),k=function(){var c=x.CurrentLibrary.getDropEvent(arguments),f=z.select({target:b}).length;z.currentlyDragging=!1;var h=m(e.getDragObject(arguments)),k=i(h,"dragId"),l=i(h,"originalScope"),p=M[k],q=p.endpoints[0];d.endpoint?x.extend({},d.endpoint):{};if(!Ra[b]||Ja[b]>0&&f>=Ja[b])return j&&j({element:a,connection:p},c),!1;q.anchor.locked=!1,l&&e.setDragScope(h,l);var r=proxyComponent.isDropAllowed(p.sourceId,oa(a),p.scope,p,null);if(p.endpointsToDeleteOnDetach&&(q===p.endpointsToDeleteOnDetach[0]?p.endpointsToDeleteOnDetach[0]=null:q===p.endpointsToDeleteOnDetach[1]&&(p.endpointsToDeleteOnDetach[1]=null)),p.suspendedEndpoint&&(p.targetId=p.suspendedEndpoint.elementId,p.target=e.getElementObject(p.suspendedEndpoint.elementId),p.endpoints[1]=p.suspendedEndpoint),r){q.detach(p,!1,!0,!1);var s=Ha[b]||z.addEndpoint(a,d);if(d.uniqueEndpoint&&(Ha[b]=s),s._makeTargetCreator=!0,null!=s.anchor.positionFinder){var t=e.getUIPosition(arguments,z.getZoom()),u=n(a,z),v=o(a),w=s.anchor.positionFinder(t,u,v,s.anchor.constructorParams);s.anchor.x=w[0],s.anchor.y=w[1]}var y=z.connect({source:q,target:s,scope:l,previousConnection:p,container:p.parent,deleteEndpointsOnDetach:g,doNotFireConnectionEvent:q.endpointWillMoveAfterConnection});p.endpoints[1]._makeTargetCreator&&p.endpoints[1].connections.length<2&&z.deleteEndpoint(p.endpoints[1]),g&&(y.endpointsToDeleteOnDetach=[q,s]),y.repaint()}else p.suspendedEndpoint&&(p.isReattach()?(p.setHover(!1),p.floatingAnchorIndex=null,p.suspendedEndpoint.addConnection(p),z.repaint(q.elementId)):q.detach(p,!1,!0,!0,c))},l=e.dragEvents.drop;c.scope=c.scope||f,c[l]=pa(c[l],k),e.initDroppable(a,c,!0)},a=V(a);for(var k=a.length&&a.constructor!=String?a:[a],l=0;l<k.length;l++)_doOne(m(k[l]));return z},this.unmakeTarget=function(a,b){a=x.CurrentLibrary.getElementObject(a);var c=oa(a);return b||(delete Ga[c],delete Ia[c],delete Ja[c],delete Ra[c]),z},this.makeTargets=function(a,b,c){for(var d=0;d<a.length;d++)z.makeTarget(a[d],b,c)};var La={},Ma={},Na={},Oa={},Pa={},Qa={},Ra={};this.makeSource=function(a,b,d){var e=x.extend({},d);x.extend(e,b),Ka(e,0);var f=x.CurrentLibrary,g=e.maxConnections||-1,h=e.onMaxConnections,i=function(a){var d=oa(a),i=e.parent,j=null!=i?z.getId(f.getElementObject(i)):d;La[j]=e,Na[j]=e.uniqueEndpoint,Oa[j]=!0;var k=f.dragEvents.stop,l=f.dragEvents.drag,m=x.extend({},e.dragOptions||{}),n=m.drag,o=m.stop,p=null,q=!1;Qa[j]=g,m.scope=m.scope||e.scope,m[l]=pa(m[l],function(){n&&n.apply(this,arguments),q=!1}),m[k]=pa(m[k],function(){if(o&&o.apply(this,arguments),z.currentlyDragging=!1,0==p.connections.length)z.deleteEndpoint(p);else{f.unbind(p.canvas,"mousedown");var a=e.anchor||z.Defaults.Anchor,b=(p.anchor,p.connections[0]);if(p.anchor=z.makeAnchor(a,d,z),e.parent){var g=f.getElementObject(e.parent);if(g){var h=p.elementId,i=e.container||z.Defaults.Container||x.Defaults.Container;p.setElement(g,i),p.endpointWillMoveAfterConnection=!1,z.anchorManager.rehomeEndpoint(h,g),b.previousConnection=null,c(H[b.scope],function(a){return a.id===b.id}),z.anchorManager.connectionDetached({sourceId:b.sourceId,targetId:b.targetId,connection:b}),ba(b)}}p.repaint(),z.repaint(p.elementId),z.repaint(b.targetId)}});var r=function(c){if(Oa[j]){var i=z.select({source:j}).length;if(Qa[j]>=0&&i>=Qa[j])return h&&h({element:a,maxConnections:g},c),!1;if(b.filter){var k=b.filter(f.getOriginalEvent(c),a);if(k===!1)return}var l=ma({elId:d}),n=((c.pageX||c.page.x)-l.left)/l.width,o=((c.pageY||c.page.y)-l.top)/l.height,r=n,s=o;if(e.parent){var t=f.getElementObject(e.parent),u=oa(t);l=ma({elId:u}),r=((c.pageX||c.page.x)-l.left)/l.width,s=((c.pageY||c.page.y)-l.top)/l.height}var v={};if(x.extend(v,e),v.isSource=!0,v.anchor=[n,o,0,0],v.parentAnchor=[r,s,0,0],v.dragOptions=m,e.parent){var w=v.container||z.Defaults.Container||x.Defaults.Container;w?v.container=w:v.container=x.CurrentLibrary.getParent(e.parent)}p=z.addEndpoint(d,v),q=!0,p.endpointWillMoveAfterConnection=null!=e.parent,p.endpointWillMoveTo=e.parent?f.getElementObject(e.parent):null;var y=function(){q&&z.deleteEndpoint(p)};z.registerListener(p.canvas,"mouseup",y),z.registerListener(a,"mouseup",y),f.trigger(p.canvas,"mousedown",c)}};z.registerListener(a,"mousedown",r),Pa[d]=r};a=V(a);for(var j=a.length&&a.constructor!=String?a:[a],k=0;k<j.length;k++)i(m(j[k]));return z},this.unmakeSource=function(a,b){a=x.CurrentLibrary.getElementObject(a);var c=oa(a),d=Pa[c];return d&&z.unregisterListener(_el,"mousedown",d),b||(delete La[c],delete Na[c],delete Oa[c],delete Pa[c],delete Qa[c]),z},this.unmakeEverySource=function(){for(var a in Oa)z.unmakeSource(a,!0);La={},Na={},Oa={},Pa={}},this.unmakeEveryTarget=function(){for(var a in Ra)z.unmakeTarget(a,!0);return Ga={},Ia={},Ja={},Ra={},z},this.makeSources=function(a,b,c){for(var d=0;d<a.length;d++)z.makeSource(a[d],b,c);return z};var Sa=function(a,b,c,d){var e="source"==a?Oa:Ra;if(f(b))e[b]=d?!e[b]:c;else if(b.length){b=V(b);for(var g=0;g<b.length;g++){var h=_el=x.CurrentLibrary.getElementObject(b[g]),h=oa(_el);e[h]=d?!e[h]:c}}return z};this.setSourceEnabled=function(a,b){return Sa("source",a,b)},this.toggleSourceEnabled=function(a){return Sa("source",a,null,!0),z.isSourceEnabled(a)},this.isSource=function(a){return a=x.CurrentLibrary.getElementObject(a),null!=Oa[oa(a)]},this.isSourceEnabled=function(a){return a=x.CurrentLibrary.getElementObject(a),Oa[oa(a)]===!0},this.setTargetEnabled=function(a,b){return Sa("target",a,b)},this.toggleTargetEnabled=function(a){return Sa("target",a,null,!0)},this.isTarget=function(a){return a=x.CurrentLibrary.getElementObject(a),null!=Ra[oa(a)]},this.isTargetEnabled=function(a){return a=x.CurrentLibrary.getElementObject(a),Ra[oa(a)]===!0},this.ready=function(a){z.bind("ready",a)},this.repaint=function(a,b,c){if("object"==typeof a)for(var d=0;d<a.length;d++)W(m(a[d]),b,c);else W(m(a),b,c);return z},this.repaintEverything=function(){for(var a in I)W(m(a));return z},this.removeAllEndpoints=function(a){var b=i(a,"id"),c=I[b];if(c)for(var d=0;d<c.length;d++)z.deleteEndpoint(c[d]);return I[b]=[],z};var Ta={},Ua=function(){for(var a in Ta)for(var b=0;b<Ta[a].length;b++){var c=Ta[a][b];x.CurrentLibrary.unbind(c.el,c.event,c.listener)}Ta={}};this.registerListener=function(a,b,c){x.CurrentLibrary.bind(a,b,c),R(Ta,b,{el:a,event:b,listener:c})},this.unregisterListener=function(a,b,d){x.CurrentLibrary.unbind(a,b,d),c(Ta,function(a){return a.type==b&&a.listener==d})},this.reset=function(){z.deleteEveryEndpoint(),z.unbind(),Ga={},Ha={},Ia={},Ja={},La={},Ma={},Na={},Qa={},Ua(),z.anchorManager.reset(),jsPlumbAdapter.headless||z.dragManager.reset()},this.setDefaultScope=function(a){return P=a,z},this.setDraggable=ia,this.setId=function(a,b,c){var d=a.constructor==String?a:z.getId(a),e=z.getConnections({source:d,scope:"*"},!0),f=z.getConnections({target:d,scope:"*"},!0);b=""+b,c||(a=x.CurrentLibrary.getElementObject(d),x.CurrentLibrary.setAttribute(a,"id",b)),a=x.CurrentLibrary.getElementObject(b),I[b]=I[d]||[];for(var g=0;g<I[b].length;g++)I[b][g].elementId=b,I[b][g].element=a,I[b][g].anchor.elementId=b;delete I[d],z.anchorManager.changeId(d,b);var h=function(c,d,e){for(var f=0;f<c.length;f++)c[f].endpoints[d].elementId=b,c[f].endpoints[d].element=a,c[f][e+"Id"]=b,c[f][e]=a};h(e,0,"source"),h(f,1,"target")},this.setIdChanged=function(a,b){z.setId(a,b,!0)},this.setDebugLog=function(a){F=a};var Va=!1,Wa=null;this.setSuspendDrawing=function(a,b){Va=a,Wa=a?(new Date).getTime():null,b&&z.repaintEverything()},this.isSuspendDrawing=function(){return Va},this.CANVAS="canvas",this.SVG="svg",this.VML="vml",this.setRenderMode=function(a){return Q=jsPlumbAdapter.setRenderMode(a)},this.getRenderMode=function(){return Q},this.show=function(a,b){return ja(a,"block",b),z},this.sizeCanvas=function(a,b,c,d,e){return a&&(a.style.height=e+"px",a.height=e,a.style.width=d+"px",a.width=d,a.style.left=b+"px",a.style.top=c+"px"),z},this.getTestHarness=function(){return{endpointsByElement:I,endpointCount:function(a){var b=I[a];return b?b.length:0},connectionCount:function(a){a=a||P;var b=H[a];return b?b.length:0},getId:oa,makeAnchor:self.makeAnchor,makeDynamicAnchor:self.makeDynamicAnchor}},this.toggle=la,this.toggleVisible=la,this.toggleDraggable=ka,this.wrap=pa,this.addListener=this.bind;var Xa=function(a,b){var c=null,d=a;if("svg"===b.tagName.toLowerCase()&&b.parentNode?c=b.parentNode:b.offsetParent&&(c=b.offsetParent),null!=c){var e="body"===c.tagName.toLowerCase()?{left:0,top:0}:n(c,z),f="body"===c.tagName.toLowerCase()?{left:0,top:0}:{left:c.scrollLeft,top:c.scrollTop};d[0]=a[0]-e.left+f.left,d[1]=a[1]-e.top+f.top}return d},Ya=function(a){var b=this;this.x=a.x||0,this.y=a.y||0,this.elementId=a.elementId;var c=a.orientation||[0,0],d=null;this.offsets=a.offsets||[0,0],b.timestamp=null,this.compute=function(a){var c=a.xy,e=a.wh,f=a.element,g=a.timestamp;return g&&g===b.timestamp?d:(d=[c[0]+b.x*e[0]+b.offsets[0],c[1]+b.y*e[1]+b.offsets[1]],d=Xa(d,f.canvas),b.timestamp=g,d)},this.getOrientation=function(a){return c},this.equals=function(a){if(!a)return!1;var b=a.getOrientation(),c=this.getOrientation();return this.x==a.x&&this.y==a.y&&this.offsets[0]==a.offsets[0]&&this.offsets[1]==a.offsets[1]&&c[0]==b[0]&&c[1]==b[1]},this.getCurrentLocation=function(){return d}},Za=function(a){var b=a.reference,c=a.referenceCanvas,d=o(m(c)),e=0,f=0,g=null,h=null;this.x=0,this.y=0,this.isFloating=!0,this.compute=function(a){var b=a.xy,c=a.element,e=[b[0]+d[0]/2,b[1]+d[1]/2];return e=Xa(e,c.canvas),h=e,e},this.getOrientation=function(a){if(g)return g;var c=b.getOrientation(a);return[Math.abs(c[0])*e*-1,Math.abs(c[1])*f*-1]},this.over=function(a){g=a.getOrientation()},this.out=function(){g=null},this.getCurrentLocation=function(){return h}},$a=function(a,b,c){this.isSelective=!0,this.isDynamic=!0;for(var d=[],e=this,f=function(a){return a.constructor==Ya?a:z.makeAnchor(a,c,z)},g=0;g<a.length;g++)d[g]=f(a[g]);this.addAnchor=function(a){d.push(f(a))},this.getAnchors=function(){return d},this.locked=!1;var h=d.length>0?d[0]:null,e=(d.length>0?0:-1,this),i=function(a,b,c,d,e){var f=d[0]+a.x*e[0],g=d[1]+a.y*e[1],h=d[0]+e[0]/2,i=d[1]+e[1]/2;return Math.sqrt(Math.pow(b-f,2)+Math.pow(c-g,2))+Math.sqrt(Math.pow(h-f,2)+Math.pow(i-g,2))},j=b||function(a,b,c,d,e){for(var f=c[0]+d[0]/2,g=c[1]+d[1]/2,h=-1,j=1/0,k=0;k<e.length;k++){var l=i(e[k],f,g,a,b);l<j&&(h=k+0,j=l)}return e[h]};this.compute=function(a){var b=a.xy,c=a.wh,f=(a.timestamp,a.txy),g=a.twh;return e.locked||null==f||null==g?h.compute(a):(a.timestamp=null,h=j(b,c,f,g,d),e.x=h.x,e.y=h.y,h.compute(a))},this.getCurrentLocation=function(){return null!=h?h.getCurrentLocation():null},this.getOrientation=function(a){return null!=h?h.getOrientation(a):[0,0]},this.over=function(a){null!=h&&h.over(a)},this.out=function(){null!=h&&h.out()}},_a={},ab={},bb={},cb={HORIZONTAL:"horizontal",VERTICAL:"vertical",DIAGONAL:"diagonal",IDENTITY:"identity"},db=function(a,b,c,d){if(a===b)return{orientation:cb.IDENTITY,a:["top","top"]};var e=Math.atan2(d.centery-c.centery,d.centerx-c.centerx),f=Math.atan2(c.centery-d.centery,c.centerx-d.centerx),g=c.left<=d.left&&c.right>=d.left||c.left<=d.right&&c.right>=d.right||c.left<=d.left&&c.right>=d.right||d.left<=c.left&&d.right>=c.right,h=c.top<=d.top&&c.bottom>=d.top||c.top<=d.bottom&&c.bottom>=d.bottom||c.top<=d.top&&c.bottom>=d.bottom||d.top<=c.top&&d.bottom>=c.bottom;if(g||h)return g?{orientation:cb.HORIZONTAL,a:c.top<d.top?["bottom","top"]:["top","bottom"],theta:e,theta2:f}:{orientation:cb.VERTICAL,a:c.left<d.left?["right","left"]:["left","right"],theta:e,theta2:f};var i=null;return d.left>c.left&&d.top>c.top?i=["right","top"]:d.left>c.left&&c.top>d.top?i=["top","left"]:d.left<c.left&&d.top<c.top?i=["top","right"]:d.left<c.left&&d.top>c.top&&(i=["left","top"]),{orientation:cb.DIAGONAL,a:i,theta:e,theta2:f}},eb=function(a,b,c,d,e,f,g){for(var h=[],i=b[e?0:1]/(d.length+1),j=0;j<d.length;j++){var k=(j+1)*i,l=f*b[e?1:0];g&&(k=b[e?0:1]-k);var m=e?k:l,n=c[0]+m,o=m/b[0],p=e?l:k,q=c[1]+p,r=p/b[1];h.push([n,q,o,r,d[j][1],d[j][2]])}return h},fb=function(a,b){return a[0]>b[0]?1:-1},gb=function(a){return function(b,c){var d=!0;return d=a?b[0][0]<c[0][0]||b[0][1]>c[0][1]:b[0][0]>c[0][0]||b[0][1]>c[0][1],d===!1?-1:1}},hb=function(a,b){var c=a[0][0]<0?-Math.PI-a[0][0]:Math.PI-a[0][0],d=b[0][0]<0?-Math.PI-b[0][0]:Math.PI-b[0][0];return c>d?1:a[0][1]>b[0][1]?1:-1},ib={top:fb,right:gb(!0),bottom:gb(!0),left:hb},jb=function(a,b){return a.sort(b)},kb=function(a,b){var c=O[a],d=K[a],e=function(b,c,d,e,f,g,h){if(e.length>0)for(var i=jb(e,ib[b]),j="right"===b||"top"===b,k=eb(b,c,d,i,f,g,j),l=function(a,b){var c=Xa([b[0],b[1]],a.canvas);ab[a.id]=[c[0],c[1],b[2],b[3]],bb[a.id]=h},m=0;m<k.length;m++){var n=k[m][4],o=n.endpoints[0].elementId===a,p=n.endpoints[1].elementId===a;o?l(n.endpoints[0],k[m]):p&&l(n.endpoints[1],k[m])}};e("bottom",c,[d.left,d.top],b.bottom,!0,1,[0,1]),e("top",c,[d.left,d.top],b.top,!0,0,[0,-1]),e("left",c,[d.left,d.top],b.left,!1,0,[-1,0]),e("right",c,[d.left,d.top],b.right,!1,1,[1,0])},lb=function(){var b={},e={},f=this,g={};this.reset=function(){b={},e={},g={}},this.newConnection=function(a){var b=a.sourceId,c=a.targetId,d=a.endpoints,f=!0,g=function(a,g,h,i,j){b==c&&h.isContinuous&&(x.CurrentLibrary.removeElement(d[1].canvas),f=!1),R(e,i,[j,g,h.constructor==$a])};g(0,d[0],d[0].anchor,c,a),f&&g(1,d[1],d[1].anchor,b,a)},this.connectionDetached=function(a){var b=a.connection||a,d=b.sourceId,h=b.targetId,i=b.endpoints,j=function(a,b,d,f,g){d.constructor==Za||c(e[f],function(a){return a[0].id==g.id})};j(1,i[1],i[1].anchor,d,b),j(0,i[0],i[0].anchor,h,b);var k=b.sourceId,l=b.targetId,m=b.endpoints[0].id,n=b.endpoints[1].id,o=function(a,b){if(a){var d=function(a){return a[4]==b};c(a.top,d),c(a.left,d),c(a.bottom,d),c(a.right,d)}};o(g[k],m),o(g[l],n),f.redraw(k),f.redraw(l)},this.add=function(a,c){R(b,c,a)},this.changeId=function(a,c){e[c]=e[a],b[c]=b[a],delete e[a],delete b[a]},this.getConnectionsFor=function(a){return e[a]||[]},this.getEndpointsFor=function(a){return b[a]||[]},this.deleteEndpoint=function(a){c(b[a.elementId],function(b){return b.id==a.id})},this.clearFor=function(a){delete b[a],b[a]=[]};var h=function(b,c,e,f,g,h,i,j,k,l,m,n){var o=-1,p=-1,q=f.endpoints[i],r=q.id,s=([1,0][i],[[c,e],f,g,h,r]),t=b[k],u=q._continuousAnchorEdge?b[q._continuousAnchorEdge]:null;if(u){var v=a(u,function(a){return a[4]==r});if(v!=-1){u.splice(v,1);for(var w=0;w<u.length;w++)d(m,u[w][1],function(a){return a.id==u[w][1].id}),d(n,u[w][1].endpoints[i],function(a){return a.id==u[w][1].endpoints[i].id})}}for(var w=0;w<t.length;w++)1==i&&t[w][3]===h&&p==-1&&(p=w),d(m,t[w][1],function(a){return a.id==t[w][1].id}),d(n,t[w][1].endpoints[i],function(a){return a.id==t[w][1].endpoints[i].id});if(o!=-1)t[o]=s;else{var x=j?p!=-1?p:0:t.length;t.splice(x,0,s)}q._continuousAnchorEdge=k};this.redraw=function(a,c,f,i){if(!Va){var j=b[a]||[],k=e[a]||[],l=[],m=[],n=[];f=f||q(),i=i||{left:0,top:0},c&&(c={left:c.left+i.left,top:c.top+i.top}),ma({elId:a,offset:c,recalc:!1,timestamp:f});for(var o=K[a],p=O[a],r={},s=0;s<k.length;s++){var t=k[s][0],u=t.sourceId,v=t.targetId,w=t.endpoints[0].anchor.isContinuous,x=t.endpoints[1].anchor.isContinuous;if(w||x){var y=u+"_"+v,z=r[y],A=t.sourceId==a?1:0;w&&!g[u]&&(g[u]={top:[],right:[],bottom:[],left:[]}),x&&!g[v]&&(g[v]={top:[],right:[],bottom:[],left:[]}),a!=v&&ma({elId:v,timestamp:f}),a!=u&&ma({elId:u,timestamp:f});var B=na(v),C=na(u);v==u&&(w||x)?h(g[u],-Math.PI/2,0,t,!1,v,0,!1,"top",u,l,m):(z||(z=db(u,v,C.o,B.o),r[y]=z),w&&h(g[u],z.theta,0,t,!1,v,0,!1,z.a[0],u,l,m),x&&h(g[v],z.theta2,-1,t,!0,u,1,!0,z.a[1],v,l,m)),w&&d(n,u,function(a){return a===u}),x&&d(n,v,function(a){return a===v}),d(l,t,function(a){return a.id==t.id}),(w&&0==A||x&&1==A)&&d(m,t.endpoints[A],function(a){return a.id==t.endpoints[A].id})}}for(var s=0;s<j.length;s++)0==j[s].connections.length&&j[s].anchor.isContinuous&&(g[a]||(g[a]={top:[],right:[],bottom:[],left:[]}),h(g[a],-Math.PI/2,0,{endpoints:[j[s],j[s]],paint:function(){}},!1,a,0,!1,"top",a,l,m),d(n,a,function(b){return b===a}));for(var s=0;s<n.length;s++)kb(n[s],g[n[s]]);for(var s=0;s<j.length;s++)j[s].paint({timestamp:f,offset:o,dimensions:p});for(var s=0;s<m.length;s++)m[s].paint({timestamp:f,offset:o,dimensions:p});for(var s=0;s<k.length;s++){var D=k[s][1];if(D.anchor.constructor==$a){D.paint({elementWithPrecedence:a}),d(l,k[s][0],function(a){return a.id==k[s][0].id});for(var E=0;E<D.connections.length;E++)D.connections[E]!==k[s][0]&&d(l,D.connections[E],function(a){return a.id==D.connections[E].id})}else D.anchor.constructor==Ya&&d(l,k[s][0],function(a){return a.id==k[s][0].id})}var F=M[a];F&&F.paint({timestamp:f,recalc:!1,elId:a});for(var s=0;s<l.length;s++)l[s].paint({elId:a,timestamp:f,recalc:!1})}},this.rehomeEndpoint=function(a,c){var d=b[a]||[],e=z.getId(c);if(e!==a){for(var g=0;g<d.length;g++)f.add(d[g],e);d.splice(0,d.length)}}};z.anchorManager=new lb,z.continuousAnchorFactory={get:function(a){var b=_a[a.elementId];return b||(b={type:"Continuous",compute:function(a){return ab[a.element.id]||[0,0]},getCurrentLocation:function(a){return ab[a.id]||[0,0]},getOrientation:function(a){return bb[a.id]||[0,0]},isDynamic:!0,isContinuous:!0},_a[a.elementId]=b),b}},jsPlumbAdapter.headless||(z.dragManager=jsPlumbAdapter.getDragManager(z)),z.recalculateOffsets=z.dragManager.updateOffsets;var mb=function(a){var b,c,d=this,g=!0;d.idPrefix="_jsplumb_c_",d.defaultLabelLocation=.5,d.defaultOverlayKeys=["Overlays","ConnectionOverlays"],this.parent=a.parent,s.apply(this,arguments),this.isVisible=function(){return g},this.setVisible=function(a){g=a,d[a?"showOverlays":"hideOverlays"](),d.connector&&d.connector.canvas&&(d.connector.canvas.style.display=a?"block":"none"),d.repaint()},this.getTypeDescriptor=function(){return"connection"},this.getDefaultType=function(){return{parameters:{},scope:null,detachable:d._jsPlumb.Defaults.ConnectionsDetachable,rettach:d._jsPlumb.Defaults.ReattachConnections,paintStyle:d._jsPlumb.Defaults.PaintStyle||x.Defaults.PaintStyle,connector:d._jsPlumb.Defaults.Connector||x.Defaults.Connector,hoverPaintStyle:d._jsPlumb.Defaults.HoverPaintStyle||x.Defaults.HoverPaintStyle,overlays:d._jsPlumb.Defaults.ConnectorOverlays||x.Defaults.ConnectorOverlays}};var j=this.applyType;this.applyType=function(a){j(a),null!=a.detachable&&d.setDetachable(a.detachable),null!=a.reattach&&d.setReattach(a.reattach),a.scope&&(d.scope=a.scope),d.setConnector(a.connector)},c=d.setHover,d.setHover=function(a){var b=z.ConnectorZIndex||x.Defaults.ConnectorZIndex;b&&d.connector.setZIndex(b+(a?1:0)),d.connector.setHover.apply(d.connector,arguments),c.apply(d,arguments)},b=function(a){null==h&&d.setHover(a,!1)},this.setConnector=function(c,g){null!=d.connector&&ha(d.connector.getDisplayElements(),d.parent);var h={_jsPlumb:d._jsPlumb,parent:a.parent,cssClass:a.cssClass,container:a.container,tooltip:d.tooltip};f(c)?this.connector=new x.Connectors[Q][c](h):e(c)&&(1==c.length?this.connector=new x.Connectors[Q][c[0]](h):this.connector=new x.Connectors[Q][c[0]](x.extend(c[1],h))),d.canvas=d.connector.canvas,t(d.connector,d,b);var i=z.ConnectorZIndex||x.Defaults.ConnectorZIndex;i&&d.connector.setZIndex(i),g||d.repaint()},this.source=m(a.source),this.target=m(a.target),a.sourceEndpoint&&(this.source=a.sourceEndpoint.endpointWillMoveTo||a.sourceEndpoint.getElement()),a.targetEndpoint&&(this.target=a.targetEndpoint.getElement()),d.previousConnection=a.previousConnection,this.sourceId=i(this.source,"id"),this.targetId=i(this.target,"id"),this.scope=a.scope,this.endpoints=[],this.endpointStyles=[];var k=function(a,b){return a?z.makeAnchor(a,b,z):null},l=function(a,b,c,e,f,g,h){var i;if(a)d.endpoints[b]=a,a.addConnection(d);else{c.endpoints||(c.endpoints=[null,null]);var j=c.endpoints[b]||c.endpoint||z.Defaults.Endpoints[b]||x.Defaults.Endpoints[b]||z.Defaults.Endpoint||x.Defaults.Endpoint;c.endpointStyles||(c.endpointStyles=[null,null]),c.endpointHoverStyles||(c.endpointHoverStyles=[null,null]);var l=c.endpointStyles[b]||c.endpointStyle||z.Defaults.EndpointStyles[b]||x.Defaults.EndpointStyles[b]||z.Defaults.EndpointStyle||x.Defaults.EndpointStyle;null==l.fillStyle&&null!=g&&(l.fillStyle=g.strokeStyle),null==l.outlineColor&&null!=g&&(l.outlineColor=g.outlineColor),null==l.outlineWidth&&null!=g&&(l.outlineWidth=g.outlineWidth);var m=c.endpointHoverStyles[b]||c.endpointHoverStyle||z.Defaults.EndpointHoverStyles[b]||x.Defaults.EndpointHoverStyles[b]||z.Defaults.EndpointHoverStyle||x.Defaults.EndpointHoverStyle;null!=h&&(null==m&&(m={}),null==m.fillStyle&&(m.fillStyle=h.strokeStyle));var n=c.anchors?c.anchors[b]:c.anchor?c.anchor:k(z.Defaults.Anchors[b],f)||k(x.Defaults.Anchors[b],f)||k(z.Defaults.Anchor,f)||k(x.Defaults.Anchor,f),o=c.uuids?c.uuids[b]:null;i=ea({paintStyle:l,hoverPaintStyle:m,endpoint:j,connections:[d],uuid:o,anchor:n,source:e,scope:c.scope,container:c.container,reattach:c.reattach||z.Defaults.ReattachConnections,detachable:c.detachable||z.Defaults.ConnectionsDetachable}),d.endpoints[b]=i,c.drawEndpoints===!1&&i.setVisible(!1,!0,!0)}return i},n=l(a.sourceEndpoint,0,a,d.source,d.sourceId,a.paintStyle,a.hoverPaintStyle);n&&R(I,this.sourceId,n);var o=l(a.targetEndpoint,1,a,d.target,d.targetId,a.paintStyle,a.hoverPaintStyle);o&&R(I,this.targetId,o),this.scope||(this.scope=this.endpoints[0].scope),d.endpointsToDeleteOnDetach=[null,null],a.deleteEndpointsOnDetach&&(a.sourceIsNew&&(d.endpointsToDeleteOnDetach[0]=d.endpoints[0]),a.targetIsNew&&(d.endpointsToDeleteOnDetach[1]=d.endpoints[1])),d.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||a.connector||z.Defaults.Connector||x.Defaults.Connector,!0),this.setPaintStyle(this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||a.paintStyle||z.Defaults.PaintStyle||x.Defaults.PaintStyle,!0),this.setHoverPaintStyle(this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||a.hoverPaintStyle||z.Defaults.HoverPaintStyle||x.Defaults.HoverPaintStyle,!0),this.paintStyleInUse=this.getPaintStyle(),ma({elId:this.sourceId,timestamp:Wa}),ma({elId:this.targetId,timestamp:Wa});var p=K[this.sourceId],r=O[this.sourceId],u=K[this.targetId],v=O[this.targetId],w=Wa||q(),y=this.endpoints[0].anchor.compute({xy:[p.left,p.top],wh:r,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[u.left,u.top],twh:v,tElement:this.endpoints[1],timestamp:w});this.endpoints[0].paint({anchorLoc:y,timestamp:w}),y=this.endpoints[1].anchor.compute({xy:[u.left,u.top],wh:v,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[p.left,p.top],twh:r,tElement:this.endpoints[0],timestamp:w}),this.endpoints[1].paint({anchorLoc:y,timestamp:w});var A=z.Defaults.ConnectionsDetachable;a.detachable===!1&&(A=!1),d.endpoints[0].connectionsDetachable===!1&&(A=!1),d.endpoints[1].connectionsDetachable===!1&&(A=!1),this.isDetachable=function(){return A===!0},this.setDetachable=function(a){A=a===!0};var B=a.reattach||d.endpoints[0].reattachConnections||d.endpoints[1].reattachConnections||z.Defaults.ReattachConnections;this.isReattach=function(){return B===!0},this.setReattach=function(a){B=a===!0};var C=a.cost||d.endpoints[0].getConnectionCost();d.getCost=function(){return C},d.setCost=function(a){C=a};var D=!(a.bidirectional===!1);null==a.bidirectional&&(D=d.endpoints[0].areConnectionsBidirectional()),d.isBidirectional=function(){return D};var E=x.extend({},this.endpoints[0].getParameters());x.extend(E,this.endpoints[1].getParameters()),x.extend(E,d.getParameters()),d.setParameters(E),this.getAttachedElements=function(){return d.endpoints},this.moveParent=function(a){var b=x.CurrentLibrary,c=b.getParent(d.connector.canvas);d.connector.bgCanvas&&(b.removeElement(d.connector.bgCanvas,c),b.appendElement(d.connector.bgCanvas,a)),b.removeElement(d.connector.canvas,c),b.appendElement(d.connector.canvas,a);for(var e=0;e<d.overlays.length;e++)d.overlays[e].isAppendedAtTopLevel&&(b.removeElement(d.overlays[e].canvas,c),b.appendElement(d.overlays[e].canvas,a),d.overlays[e].reattachListeners&&d.overlays[e].reattachListeners(d.connector));d.connector.reattachListeners&&d.connector.reattachListeners()};var F=null;this.paint=function(a){if(g){a=a||{};var b=a.elId,c=a.ui,e=a.recalc,f=a.timestamp,h=!1,i=h?this.sourceId:this.targetId,j=(h?this.targetId:this.sourceId,h?0:1),k=h?1:0;if(null==f||f!=F){for(var l=ma({elId:b,offset:c,recalc:e,timestamp:f}),m=ma({elId:i,timestamp:f}),n=this.endpoints[k],o=this.endpoints[j],p=n.anchor.getCurrentLocation(n),q=o.anchor.getCurrentLocation(o),r=0,s=0;s<d.overlays.length;s++){var t=d.overlays[s];t.isVisible()&&(r=Math.max(r,t.computeMaxSize()))}var u=this.connector.compute(p,q,this.endpoints[k],this.endpoints[j],this.endpoints[k].anchor,this.endpoints[j].anchor,d.paintStyleInUse.lineWidth,r,l,m);d.connector.paint(u,d.paintStyleInUse);for(var s=0;s<d.overlays.length;s++){var t=d.overlays[s];t.isVisible&&(d.overlayPlacements[s]=t.draw(d.connector,d.paintStyleInUse,u))}}F=f}},this.repaint=function(a){a=a||{};var b=!(a.recalc===!1);this.paint({elId:this.sourceId,recalc:b,timestamp:a.timestamp})};var G=a.type||d.endpoints[0].connectionType||d.endpoints[1].connectionType;G&&d.addType(G)},nb=function(a){var b=!1;return{drag:function(){if(b)return b=!1,!0;var c=x.CurrentLibrary.getUIPosition(arguments,z.getZoom()),d=a.element;d&&(x.CurrentLibrary.setOffset(d,c),W(m(d),c))},stopDrag:function(){b=!0}}},ob=function(a,b,c,d,e){var f=new Za({reference:b,referenceCanvas:d});return ea({paintStyle:a,endpoint:c,anchor:f,source:e,scope:"__floating"})},pb=function(a,b){var c=document.createElement("div");c.style.position="absolute";var d=m(c);S(c,b);var e=oa(d);ma({elId:e}),a.id=e,a.element=d},qb=function(b){var d=this;d.idPrefix="_jsplumb_e_",d.defaultLabelLocation=[.5,.5],d.defaultOverlayKeys=["Overlays","EndpointOverlays"],this.parent=b.parent,s.apply(this,arguments),b=b||{},this.getTypeDescriptor=function(){return"endpoint"},this.getDefaultType=function(){return{parameters:{},scope:null,maxConnections:d._jsPlumb.Defaults.MaxConnections,paintStyle:d._jsPlumb.Defaults.EndpointStyle||x.Defaults.EndpointStyle,endpoint:d._jsPlumb.Defaults.Endpoint||x.Defaults.Endpoint,hoverPaintStyle:d._jsPlumb.Defaults.EndpointHoverStyle||x.Defaults.EndpointHoverStyle,overlays:d._jsPlumb.Defaults.EndpointOverlays||x.Defaults.EndpointOverlays,connectorStyle:b.connectorStyle,connectorHoverStyle:b.connectorHoverStyle,connectorClass:b.connectorClass,connectorHoverClass:b.connectorHoverClass,connectorOverlays:b.connectorOverlays,connector:b.connector,connectorTooltip:b.connectorTooltip}};var g=this.applyType;this.applyType=function(a){g(a),null!=a.maxConnections&&(D=a.maxConnections),a.scope&&(d.scope=a.scope),d.connectorStyle=a.connectorStyle,d.connectorHoverStyle=a.connectorHoverStyle,d.connectorOverlays=a.connectorOverlays,d.connector=a.connector,d.connectorTooltip=a.connectorTooltip,d.connectionType=a.connectionType,d.connectorClass=a.connectorClass,d.connectorHoverClass=a.connectorHoverClass};var h=!0,k=!(b.enabled===!1);this.isVisible=function(){return h},this.setVisible=function(a,b,c){if(h=a,d.canvas&&(d.canvas.style.display=a?"block":"none"),d[a?"showOverlays":"hideOverlays"](),!b)for(var e=0;e<d.connections.length;e++)if(d.connections[e].setVisible(a),!c){var f=d===d.connections[e].endpoints[0]?1:0;1==d.connections[e].endpoints[f].connections.length&&d.connections[e].endpoints[f].setVisible(a,!0,!0)}},this.isEnabled=function(){return k},this.setEnabled=function(a){k=a};var l=b.source,o=b.uuid,p=null,q=null;o&&(J[o]=d);var r=i(l,"id");this.elementId=r,this.element=l;var u=b.connectionCost;this.getConnectionCost=function(){return u},this.setConnectionCost=function(a){u=a};var v=b.connectionsBidirectional!==!1;this.areConnectionsBidirectional=function(){return v},this.setConnectionsBidirectional=function(a){v=a},d.anchor=b.anchor?z.makeAnchor(b.anchor,r,z):b.anchors?z.makeAnchor(b.anchors,r,z):z.makeAnchor(z.Defaults.Anchor||"TopCenter",r,z),b._transient||z.anchorManager.add(d,r);var w=null,y=null;this.setEndpoint=function(a){var c={_jsPlumb:d._jsPlumb,parent:b.parent,container:b.container,tooltip:b.tooltip,connectorTooltip:b.connectorTooltip,endpoint:d};f(a)?w=new x.Endpoints[Q][a](c):e(a)?(c=x.extend(a[1],c),w=new x.Endpoints[Q][a[0]](c)):w=a.clone();var g=x.extend({},c);w.clone=function(){var a=new Object;return w.constructor.apply(a,[g]),a},d.endpoint=w,d.type=d.endpoint.type},this.setEndpoint(b.endpoint||z.Defaults.Endpoint||x.Defaults.Endpoint||"Dot"),y=w;var A=d.setHover;d.setHover=function(){d.endpoint.setHover.apply(d.endpoint,arguments),A.apply(d,arguments)};var B=function(a){d.connections.length>0?d.connections[0].setHover(a,!1):d.setHover(a)};t(d.endpoint,d,B),this.setPaintStyle(b.paintStyle||b.style||z.Defaults.EndpointStyle||x.Defaults.EndpointStyle,!0),this.setHoverPaintStyle(b.hoverPaintStyle||z.Defaults.EndpointHoverStyle||x.Defaults.EndpointHoverStyle,!0),this.paintStyleInUse=this.getPaintStyle();var C=this.getPaintStyle();this.connectorStyle=b.connectorStyle,this.connectorHoverStyle=b.connectorHoverStyle,this.connectorOverlays=b.connectorOverlays,this.connector=b.connector,this.connectorTooltip=b.connectorTooltip,this.connectorClass=b.connectorClass,this.connectorHoverClass=b.connectorHoverClass,this.isSource=b.isSource||!1,this.isTarget=b.isTarget||!1;var D=b.maxConnections||z.Defaults.MaxConnections;this.getAttachedElements=function(){return d.connections},this.canvas=this.endpoint.canvas,this.connections=b.connections||[],this.scope=b.scope||P,this.connectionType=b.connectionType,this.timestamp=null,d.reattachConnections=b.reattach||z.Defaults.ReattachConnections,d.connectionsDetachable=z.Defaults.ConnectionsDetachable,b.connectionsDetachable!==!1&&b.detachable!==!1||(d.connectionsDetachable=!1);var E=b.dragAllowedWhenFull||!0;b.onMaxConnections&&d.bind("maxConnections",b.onMaxConnections),this.computeAnchor=function(a){return d.anchor.compute(a)},this.addConnection=function(a){d.connections.push(a)},this.detach=function(b,e,f,g,h){var i=a(d.connections,function(a){return a.id==b.id}),j=!1;if(g=g!==!1,i>=0&&(f||b._forceDetach||b.isDetachable()||b.isDetachAllowed(b))){var k=b.endpoints[0]==d?b.endpoints[1]:b.endpoints[0];if(f||b._forceDetach||d.isDetachAllowed(b)){if(d.connections.splice(i,1),!e&&(k.detach(b,!0,f),b.endpointsToDeleteOnDetach))for(var l=0;l<b.endpointsToDeleteOnDetach.length;l++){var m=b.endpointsToDeleteOnDetach[l];m&&0==m.connections.length&&z.deleteEndpoint(m)}ha(b.connector.getDisplayElements(),b.parent),c(H[b.scope],function(a){return a.id==b.id}),j=!0;var n=!e&&g;qa(b,n,h)}}return j},this.detachAll=function(a,b){for(;d.connections.length>0;)d.detach(d.connections[0],!1,!0,a,b)},this.detachFrom=function(a,b,c){
for(var e=[],f=0;f<d.connections.length;f++)d.connections[f].endpoints[1]!=a&&d.connections[f].endpoints[0]!=a||e.push(d.connections[f]);for(var f=0;f<e.length;f++)d.detach(e[f],!1,!0,b,c)&&e[f].setHover(!1,!1)},this.detachFromConnection=function(b){var c=a(d.connections,function(a){return a.id==b.id});c>=0&&d.connections.splice(c,1)},this.getElement=function(){return l},this.setElement=function(a,b){var e=oa(a);c(I[d.elementId],function(a){return a.id==d.id}),l=m(a),r=oa(l),d.elementId=r;var f=da({source:e,container:b}),g=V.getParent(d.canvas);V.removeElement(d.canvas,g),V.appendElement(d.canvas,f);for(var h=0;h<d.connections.length;h++)d.connections[h].moveParent(f),d.connections[h].sourceId=r,d.connections[h].source=l;R(I,e,d)},this.getUuid=function(){return o},this.makeInPlaceCopy=function(){var a=d.anchor.getCurrentLocation(d),b=d.anchor.getOrientation(d),c={compute:function(){return[a[0],a[1]]},getCurrentLocation:function(){return[a[0],a[1]]},getOrientation:function(){return b}};return ea({anchor:c,source:l,paintStyle:this.getPaintStyle(),endpoint:w,_transient:!0,scope:d.scope})},this.isConnectedTo=function(a){var b=!1;if(a)for(var c=0;c<d.connections.length;c++)if(d.connections[c].endpoints[1]==a){b=!0;break}return b},this.isFloating=function(){return null!=p},this.connectorSelector=function(){var a=d.connections[0];return d.isTarget&&a?a:d.connections.length<D||D==-1?null:a},this.isFull=function(){return!(d.isFloating()||D<1||d.connections.length<D)},this.setDragAllowedWhenFull=function(a){E=a},this.setStyle=d.setPaintStyle,this.equals=function(a){return this.anchor.equals(a.anchor)};var F=function(a){var b=0;if(null!=a)for(var c=0;c<d.connections.length;c++)if(d.connections[c].sourceId==a||d.connections[c].targetId==a){b=c;break}return d.connections[b]};if(this.paint=function(a){a=a||{};var b=a.timestamp,c=!(a.recalc===!1);if(!b||d.timestamp!==b){ma({elId:r,timestamp:b,recalc:c});var e=a.offset||K[r];if(e){var f=a.anchorPoint,g=a.connectorPaintStyle;if(null==f){var h=a.dimensions||O[r];null!=e&&null!=h||(ma({elId:r,timestamp:b}),e=K[r],h=O[r]);var i={xy:[e.left,e.top],wh:h,element:d,timestamp:b};if(c&&d.anchor.isDynamic&&d.connections.length>0){var j=F(a.elementWithPrecedence),k=j.endpoints[0]==d?1:0,l=0==k?j.sourceId:j.targetId,m=K[l],n=O[l];i.txy=[m.left,m.top],i.twh=n,i.tElement=j.endpoints[k]}f=d.anchor.compute(i)}var o=w.compute(f,d.anchor.getOrientation(d),d.paintStyleInUse,g||d.paintStyleInUse);w.paint(o,d.paintStyleInUse,d.anchor),d.timestamp=b;for(var p=0;p<d.overlays.length;p++){var q=d.overlays[p];q.isVisible&&(d.overlayPlacements[p]=q.draw(d.endpoint,d.paintStyleInUse,o))}}}},this.repaint=this.paint,this.removeConnection=this.detach,x.CurrentLibrary.isDragSupported(l)){var G={id:null,element:null},L=null,N=!1,S=null,T=nb(G),U=function(){L=d.connectorSelector();var a=!0;if(d.isEnabled()||(a=!1),null!=L||b.isSource||(a=!1),b.isSource&&d.isFull()&&!E&&(a=!1),null==L||L.isDetachable()||(a=!1),a===!1)return x.CurrentLibrary.stopDrag&&x.CurrentLibrary.stopDrag(),T.stopDrag(),!1;L&&!d.isFull()&&b.isSource&&(L=null),ma({elId:r}),q=d.makeInPlaceCopy(),q.referenceEndpoint=d,q.paint(),pb(G,d.parent);var c=m(q.canvas),e=n(c,z),f=Xa([e.left,e.top],q.canvas);if(x.CurrentLibrary.setOffset(G.element,{left:f[0],top:f[1]}),d.parentAnchor&&(d.anchor=z.makeAnchor(d.parentAnchor,d.elementId,z)),j(m(d.canvas),"dragId",G.id),j(m(d.canvas),"elId",r),b.proxy&&d.setPaintStyle(b.proxy.paintStyle),p=ob(d.getPaintStyle(),d.anchor,w,d.canvas,G.element),null==L)d.anchor.locked=!0,d.setHover(!1,!1),L=aa({sourceEndpoint:d,targetEndpoint:p,source:d.endpointWillMoveTo||m(l),target:G.element,anchors:[d.anchor,p.anchor],paintStyle:b.connectorStyle,hoverPaintStyle:b.connectorHoverStyle,connector:b.connector,overlays:b.connectorOverlays,type:d.connectionType,cssClass:d.connectorClass,hoverClass:d.connectorHoverClass});else{N=!0,L.setHover(!1),ca(m(q.canvas),!1,!0);var g=L.endpoints[0].id==d.id?0:1;L.floatingAnchorIndex=g,d.detachFromConnection(L);var h=m(d.canvas),i=x.CurrentLibrary.getDragScope(h);j(h,"originalScope",i);var k=x.CurrentLibrary.getDropScope(h);x.CurrentLibrary.setDragScope(h,k),0==g?(S=[L.source,L.sourceId,_,i],L.source=G.element,L.sourceId=G.id):(S=[L.target,L.targetId,_,i],L.target=G.element,L.targetId=G.id),L.endpoints[0==g?1:0].anchor.locked=!0,L.suspendedEndpoint=L.endpoints[g],L.suspendedEndpoint.setHover(!1),p.referenceEndpoint=L.suspendedEndpoint,L.endpoints[g]=p,ra(L)}M[G.id]=L,p.addConnection(L),R(I,G.id,p),z.currentlyDragging=!0},V=x.CurrentLibrary,W=b.dragOptions||{},X=x.extend({},V.defaultDragOptions),Y=V.dragEvents.start,Z=V.dragEvents.stop,$=V.dragEvents.drag;W=x.extend(X,W),W.scope=W.scope||d.scope,W[Y]=pa(W[Y],U),W[$]=pa(W[$],T.drag),W[Z]=pa(W[Z],function(){var a=V.getDropEvent(arguments);z.currentlyDragging=!1,c(I[G.id],function(a){return a.id==p.id}),ha([G.element[0],p.canvas],l),ga(q.canvas,l),z.anchorManager.clearFor(G.id);var b=null==L.floatingAnchorIndex?1:L.floatingAnchorIndex;L.endpoints[0==b?1:0].anchor.locked=!1,d.setPaintStyle(C),L.endpoints[b]==p&&(N&&L.suspendedEndpoint?(0==b?(L.source=S[0],L.sourceId=S[1]):(L.target=S[0],L.targetId=S[1]),x.CurrentLibrary.setDragScope(S[2],S[3]),L.endpoints[b]=L.suspendedEndpoint,(L.isReattach()||L._forceReattach||L._forceDetach||!L.endpoints[0==b?1:0].detach(L,!1,!1,!0,a))&&(L.setHover(!1),L.floatingAnchorIndex=null,L.suspendedEndpoint.addConnection(L),z.repaint(S[1])),L._forceDetach=null,L._forceReattach=null):(ha(L.connector.getDisplayElements(),d.parent),d.detachFromConnection(L))),d.anchor.locked=!1,d.paint({recalc:!1}),sa(L),L=null,q=null,delete I[p.elementId],p.anchor=null,p=null,z.currentlyDragging=!1});var _=m(d.canvas);x.CurrentLibrary.initDraggable(_,W,!0)}var ca=function(a,c,e,f){if((b.isTarget||c)&&x.CurrentLibrary.isDropSupported(l)){var g=b.dropOptions||z.Defaults.DropOptions||x.Defaults.DropOptions;g=x.extend({},g),g.scope=g.scope||d.scope;var h=x.CurrentLibrary.dragEvents.drop,j=x.CurrentLibrary.dragEvents.over,k=x.CurrentLibrary.dragEvents.out,n=function(){var a=x.CurrentLibrary.getDropEvent(arguments),b=m(x.CurrentLibrary.getDragObject(arguments)),c=i(b,"dragId"),e=(i(b,"elId"),i(b,"originalScope")),g=M[c],h=g.suspendedEndpoint&&(g.suspendedEndpoint.id==d.id||d.referenceEndpoint&&g.suspendedEndpoint.id==d.referenceEndpoint.id);if(h)return void(g._forceReattach=!0);if(null!=g){var j=null==g.floatingAnchorIndex?1:g.floatingAnchorIndex;e&&x.CurrentLibrary.setDragScope(b,e);var k=null==f||f.isEnabled();if(d.isFull()&&d.fire("maxConnections",{endpoint:d,connection:g,maxConnections:D},a),!d.isFull()&&(0!=j||d.isSource)&&(1!=j||d.isTarget)&&k){var l=!0;g.suspendedEndpoint&&g.suspendedEndpoint.id!=d.id&&(0==j?(g.source=g.suspendedEndpoint.element,g.sourceId=g.suspendedEndpoint.elementId):(g.target=g.suspendedEndpoint.element,g.targetId=g.suspendedEndpoint.elementId),g.isDetachAllowed(g)&&g.endpoints[j].isDetachAllowed(g)&&g.suspendedEndpoint.isDetachAllowed(g)&&z.checkCondition("beforeDetach",g)||(l=!1)),0==j?(g.source=d.element,g.sourceId=d.elementId):(g.target=d.element,g.targetId=d.elementId);var n=function(){g.floatingAnchorIndex=null},o=function(){g.endpoints[j].detachFromConnection(g),g.suspendedEndpoint&&g.suspendedEndpoint.detachFromConnection(g),g.endpoints[j]=d,d.addConnection(g);var b=d.getParameters();for(var c in b)g.setParameter(c,b[c]);if(g.suspendedEndpoint){var e=g.suspendedEndpoint.getElement(),f=g.suspendedEndpoint.elementId;qa({source:0==j?e:g.source,target:1==j?e:g.target,sourceId:0==j?f:g.sourceId,targetId:1==j?f:g.targetId,sourceEndpoint:0==j?g.suspendedEndpoint:g.endpoints[0],targetEndpoint:1==j?g.suspendedEndpoint:g.endpoints[1],connection:g},!0,a)}else b.draggable&&x.CurrentLibrary.initDraggable(d.element,W,!0);ba(g,null,a),n()},p=function(){g.suspendedEndpoint&&(g.endpoints[j]=g.suspendedEndpoint,g.setHover(!1),g._forceDetach=!0,0==j?(g.source=g.suspendedEndpoint.element,g.sourceId=g.suspendedEndpoint.elementId):(g.target=g.suspendedEndpoint.element,g.targetId=g.suspendedEndpoint.elementId),g.suspendedEndpoint.addConnection(g),g.endpoints[0].repaint(),g.repaint(),z.repaint(g.source.elementId),g._forceDetach=!1),n()};l=l&&d.isDropAllowed(g.sourceId,g.targetId,g.scope,g,d),l?o():p()}z.currentlyDragging=!1,delete M[c],g.suspendedEndpoint=null}};g[h]=pa(g[h],n),g[j]=pa(g[j],function(){var a=x.CurrentLibrary.getDragObject(arguments),b=i(m(a),"dragId"),c=M[b];if(null!=c){var e=null==c.floatingAnchorIndex?1:c.floatingAnchorIndex,f=d.isTarget&&0!=c.floatingAnchorIndex||c.suspendedEndpoint&&d.referenceEndpoint&&d.referenceEndpoint.id==c.suspendedEndpoint.id;f&&c.endpoints[e].anchor.over(d.anchor)}}),g[k]=pa(g[k],function(){var a=x.CurrentLibrary.getDragObject(arguments),b=i(m(a),"dragId"),c=M[b];if(null!=c){var e=null==c.floatingAnchorIndex?1:c.floatingAnchorIndex,f=d.isTarget&&0!=c.floatingAnchorIndex||c.suspendedEndpoint&&d.referenceEndpoint&&d.referenceEndpoint.id==c.suspendedEndpoint.id;f&&c.endpoints[e].anchor.out()}}),x.CurrentLibrary.initDroppable(a,g,!0,e)}};return ca(m(d.canvas),!0,!(b._transient||d.anchor.isFloating),d),b.type&&d.addType(b.type),d}},x=new w;"undefined"!=typeof window&&(window.jsPlumb=x),x.getInstance=function(a){var b=new w(a);return b.init(),b},"function"==typeof define&&define.amd&&define.amd.jsPlumb&&define("jsplumb",[],function(){return x});var y=function(a,b,c,d,e,f){return function(g){g=g||{};var h=g.jsPlumbInstance.makeAnchor([a,b,c,d,0,0],g.elementId,g.jsPlumbInstance);return h.type=e,f&&f(h,g),h}};x.Anchors.TopCenter=y(.5,0,0,-1,"TopCenter"),x.Anchors.BottomCenter=y(.5,1,0,1,"BottomCenter"),x.Anchors.LeftMiddle=y(0,.5,-1,0,"LeftMiddle"),x.Anchors.RightMiddle=y(1,.5,1,0,"RightMiddle"),x.Anchors.Center=y(.5,.5,0,0,"Center"),x.Anchors.TopRight=y(1,0,0,-1,"TopRight"),x.Anchors.BottomRight=y(1,1,0,1,"BottomRight"),x.Anchors.TopLeft=y(0,0,0,-1,"TopLeft"),x.Anchors.BottomLeft=y(0,1,0,1,"BottomLeft"),x.Defaults.DynamicAnchors=function(a){return a.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],a.elementId,a.jsPlumbInstance)},x.Anchors.AutoDefault=function(a){var b=a.jsPlumbInstance.makeDynamicAnchor(x.Defaults.DynamicAnchors(a));return b.type="AutoDefault",b},x.Anchors.Assign=y(0,0,0,0,"Assign",function(a,b){var c=b.position||"Fixed";a.positionFinder=c.constructor==String?b.jsPlumbInstance.AnchorPositionFinders[c]:c,a.constructorParams=b}),x.Anchors.Continuous=function(a){return a.jsPlumbInstance.continuousAnchorFactory.get(a)},x.AnchorPositionFinders={Fixed:function(a,b,c,d){return[(a.left-b.left)/c[0],(a.top-b.top)/c[1]]},Grid:function(a,b,c,d){var e=a.left-b.left,f=a.top-b.top,g=c[0]/d.grid[0],h=c[1]/d.grid[1],i=Math.floor(e/g),j=Math.floor(f/h);return[(i*g+g/2)/c[0],(j*h+h/2)/c[1]]}},x.Anchors.Perimeter=function(a){a=a||{};var b=a.anchorCount||60,c=a.shape;if(!c)throw new Error("no shape supplied to Perimeter Anchor type");var d=function(){for(var a=.5,c=2*Math.PI/b,d=0,e=[],f=0;f<b;f++){var g=a+a*Math.sin(d),h=a+a*Math.cos(d);e.push([g,h,0,0]),d+=c}return e},e=function(a){for(var c=b/a.length,d=[],e=function(a,e,f,g,h){c=b*h;for(var i=(f-a)/c,j=(g-e)/c,k=0;k<c;k++)d.push([a+i*k,e+j*k,0,0])},f=0;f<a.length;f++)e.apply(null,a[f]);return d},f=function(a){for(var b=[],c=0;c<a.length;c++)b.push([a[c][0],a[c][1],a[c][2],a[c][3],1/a.length]);return e(b)},g=function(){return f([[0,0,1,0],[1,0,1,1],[1,1,0,1],[0,1,0,0]])},h={circle:d,ellipse:d,diamond:function(){return f([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]])},rectangle:g,square:g,triangle:function(){return f([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]])},path:function(a){for(var b=a.points,c=[],d=0,f=0;f<b.length-1;f++){var g=Math.sqrt(Math.pow(b[f][2]-b[f][0])+Math.pow(b[f][3]-b[f][1]));d+=g,c.push([b[f][0],b[f][1],b[f+1][0],b[f+1][1],g])}for(var f=0;f<c.length;f++)c[f][4]=c[f][4]/d;return e(c)}},i=function(a,b){for(var c=[],d=b/180*Math.PI,e=0;e<a.length;e++){var f=a[e][0]-.5,g=a[e][1]-.5;c.push([.5+(f*Math.cos(d)-g*Math.sin(d)),.5+(f*Math.sin(d)+g*Math.cos(d)),a[e][2],a[e][3]])}return c};if(!h[c])throw new Error("Shape ["+c+"] is unknown by Perimeter Anchor type");var j=h[c](a);a.rotation&&(j=i(j,a.rotation));var k=a.jsPlumbInstance.makeDynamicAnchor(j);return k.type="Perimeter",k}}(),function(){jsPlumb.DOMElementComponent=function(a){jsPlumb.jsPlumbUIComponent.apply(this,arguments),this.mousemove=this.dblclick=this.click=this.mousedown=this.mouseup=function(a){}},jsPlumb.Connectors.Straight=function(){this.type="Straight";var a,b,c,d,e,f,g,h,i,j,k,l,m=this,n=null;this.compute=function(m,o,p,q,r,s,t,u){var v=Math.abs(m[0]-o[0]),w=Math.abs(m[1]-o[1]),x=.45*v,y=.45*w;v*=1.9,w*=1.9;var z=Math.min(m[0],o[0])-x,A=Math.min(m[1],o[1])-y,B=Math.max(2*t,u);return v<B&&(v=B,z=m[0]+(o[0]-m[0])/2-B/2,x=(v-Math.abs(m[0]-o[0]))/2),w<B&&(w=B,A=m[1]+(o[1]-m[1])/2-B/2,y=(w-Math.abs(m[1]-o[1]))/2),h=m[0]<o[0]?x:v-x,i=m[1]<o[1]?y:w-y,j=m[0]<o[0]?v-x:x,k=m[1]<o[1]?w-y:y,n=[z,A,v,w,h,i,j,k],d=j-h,e=k-i,a=jsPlumbUtil.gradient({x:h,y:i},{x:j,y:k}),b=-1/a,c=-1*(a*h-i),f=Math.atan(a),g=Math.atan(b),l=Math.sqrt(d*d+e*e),n},this.pointOnPath=function(a,b){if(0!=a||b){if(1!=a||b){var c=b?a>0?a:l+a:a*l;return jsPlumbUtil.pointOnLine({x:h,y:i},{x:j,y:k},c)}return{x:j,y:k}}return{x:h,y:i}},this.gradientAtPoint=function(b){return a},this.pointAlongPathFrom=function(a,b,c){var d=m.pointOnPath(a,c),e=1==a?{x:h+10*(j-h),y:i+10*(i-k)}:b<=0?{x:h,y:i}:{x:j,y:k};return b<=0&&Math.abs(b)>1&&(b*=-1),jsPlumbUtil.pointOnLine(d,e,b)}},jsPlumb.Connectors.Bezier=function(a){var b=this;a=a||{},this.majorAnchor=a.curviness||150,this.minorAnchor=10;var c=null;this.type="Bezier",this._findControlPoint=function(a,c,d,e,f,g,h){var i=g.getOrientation(e),j=h.getOrientation(f),k=i[0]!=j[0]||i[1]==j[1],l=[],m=b.majorAnchor,n=b.minorAnchor;return k?(0==j[0]?l.push(d[0]<c[0]?a[0]+n:a[0]-n):l.push(a[0]+m*j[0]),0==j[1]?l.push(d[1]<c[1]?a[1]+n:a[1]-n):l.push(a[1]+m*i[1])):(0==i[0]?l.push(c[0]<d[0]?a[0]+n:a[0]-n):l.push(a[0]-m*i[0]),0==i[1]?l.push(c[1]<d[1]?a[1]+n:a[1]-n):l.push(a[1]+m*j[1])),l};var d,e,f,g,h,f,i,j,k,l,m;this.compute=function(a,n,o,p,q,r,s,t){s=Math.max(t,s||0),l=Math.abs(a[0]-n[0])+s,m=Math.abs(a[1]-n[1])+s,j=Math.min(a[0],n[0])-s/2,k=Math.min(a[1],n[1])-s/2,f=a[0]<n[0]?l-s/2:s/2,i=a[1]<n[1]?m-s/2:s/2,g=a[0]<n[0]?s/2:l-s/2,h=a[1]<n[1]?s/2:m-s/2,d=b._findControlPoint([f,i],a,n,o,p,q,r),e=b._findControlPoint([g,h],n,a,p,o,r,q);var u=Math.min(f,g),v=Math.min(d[0],e[0]),w=Math.min(u,v),x=Math.max(f,g),y=Math.max(d[0],e[0]),z=Math.max(x,y);if(z>l&&(l=z),w<0){j+=w;var A=Math.abs(w);l+=A,d[0]+=A,f+=A,g+=A,e[0]+=A}var B=Math.min(i,h),C=Math.min(d[1],e[1]),D=Math.min(B,C),E=Math.max(i,h),F=Math.max(d[1],e[1]),G=Math.max(E,F);if(G>m&&(m=G),D<0){k+=D;var H=Math.abs(D);m+=H,d[1]+=H,i+=H,h+=H,e[1]+=H}if(t&&l<t){var I=(t-l)/2;l=t,j-=I,f+=I,g+=I,d[0]=d[0]+I,e[0]=e[0]+I}if(t&&m<t){var I=(t-m)/2;m=t,k-=I,i+=I,h+=I,d[1]=d[1]+I,e[1]=e[1]+I}return c=[j,k,l,m,f,i,g,h,d[0],d[1],e[0],e[1]]};var n=function(){return[{x:f,y:i},{x:d[0],y:d[1]},{x:e[0],y:e[1]},{x:g,y:h}]},o=function(a,b,c){return c&&(b=jsBezier.locationAlongCurveFrom(a,b>0?0:1,b)),b};this.pointOnPath=function(a,b){var c=n();return a=o(c,a,b),jsBezier.pointOnCurve(c,a)},this.gradientAtPoint=function(a,b){var c=n();return a=o(c,a,b),jsBezier.gradientAtPoint(c,a)},this.pointAlongPathFrom=function(a,b,c){var d=n();return a=o(d,a,c),jsBezier.pointAlongCurveFrom(d,a,b)}},jsPlumb.Connectors.Flowchart=function(a){this.type="Flowchart",a=a||{};var b,c,d=this,e=a.stub||a.minStubLength||30,f=jsPlumbUtil.isArray(e)?e[0]:e,g=jsPlumbUtil.isArray(e)?e[1]:e,h=a.gap||0,i=a.midpoint||.5,j=[],k=0,l=[],m=[],n=[],o=-(1/0),p=-(1/0),q=1/0,r=1/0,s=(a.grid,function(a,b,c,d){for(var e=0,f=0;f<j.length;f++)m[f]=j[f][5]/k,l[f]=[e,e+=j[f][5]/k]}),t=function(){n.push(j.length);for(var a=0;a<j.length;a++)n.push(j[a][0]),n.push(j[a][1])},u=function(a,b,c,d,e,f){var g=0==j.length?c:j[j.length-1][0],h=0==j.length?d:j[j.length-1][1],i=a==g?1/0:0,l=Math.abs(a==g?b-h:a-g);j.push([a,b,g,h,i,l]),k+=l,o=Math.max(o,a),p=Math.max(p,b),q=Math.min(q,a),r=Math.min(r,b)},v=function(a,b){b&&(a=a>0?a/k:(k+a)/k);for(var c=l.length-1,d=1,e=0;e<l.length;e++)if(l[e][1]>=a){c=e,d=(a-l[e][0])/m[e];break}return{segment:j[c],proportion:d,index:c}};this.compute=function(a,e,v,w,x,y,z,A,B,C){j=[],l=[],k=0,m=[],o=p=-(1/0),q=r=1/0,d.lineWidth=z,b=e[0]<a[0],c=e[1]<a[1];var D=z||1,E=D/2+(f+g),F=D/2+(g+f),G=D/2+(f+g),H=D/2+(g+f),I=x.orientation||x.getOrientation(v),J=y.orientation||y.getOrientation(w),K=b?e[0]:a[0],L=c?e[1]:a[1],M=Math.abs(e[0]-a[0])+E+F,N=Math.abs(e[1]-a[1])+G+H;if(0==I[0]&&0==I[1]||0==J[0]&&0==J[1]){var O=M>N?0:1,P=[1,0][O];I=[],J=[],I[O]=a[O]>e[O]?-1:1,J[O]=a[O]>e[O]?1:-1,I[P]=0,J[P]=0}var Q=b?M-F+h*I[0]:E+h*I[0],R=c?N-H+h*I[1]:G+h*I[1],S=b?E+h*J[0]:M-F+h*J[0],T=c?G+h*J[1]:N-H+h*J[1],U=Q+I[0]*f,V=R+I[1]*f,W=S+J[0]*g,X=T+J[1]*g,Y=Math.abs(Q-S)>f+g,Z=Math.abs(R-T)>f+g,$=U+(W-U)*i,_=V+(X-V)*i,aa=I[0]*J[0]+I[1]*J[1],ba=aa==-1,ca=1==aa;K-=E,L-=G,n=[K,L,M,N,Q,R,S,T];var da=0==I[0]?"y":"x",ea=ba?"opposite":ca?"orthogonal":"perpendicular",fa=jsPlumbUtil.segment([Q,R],[S,T]),ga=I["x"==da?0:1]==-1,ha={x:[null,4,3,2,1],y:[null,2,1,4,3]};ga&&(fa=ha[da][fa]),u(U,V,Q,R,S,T);var ia={oppositex:function(){if(v.elementId==w.elementId){var a=V+(1-x.y)*B.height+Math.max(f,g);return[[U,a],[W,a]]}return!Y||1!=fa&&2!=fa?[[U,_],[W,_]]:[[$,R],[$,T]]},orthogonalx:function(){return 1==fa||2==fa?[[W,V]]:[[U,X]]},perpendicularx:function(){var a=(T+R)/2;return 1==fa&&1==J[1]||2==fa&&J[1]==-1?Math.abs(S-Q)>Math.max(f,g)?[[W,V]]:[[U,V],[U,a],[W,a]]:3==fa&&J[1]==-1||4==fa&&1==J[1]?[[U,a],[W,a]]:3==fa&&1==J[1]||4==fa&&J[1]==-1?[[U,X]]:1==fa&&J[1]==-1||2==fa&&1==J[1]?Math.abs(S-Q)>Math.max(f,g)?[[$,V],[$,X]]:[[U,X]]:void 0},oppositey:function(){if(v.elementId==w.elementId){var a=U+(1-x.x)*B.width+Math.max(f,g);return[[a,V],[a,X]]}return!Z||2!=fa&&3!=fa?[[$,V],[$,X]]:[[Q,_],[S,_]]},orthogonaly:function(){return 2==fa||3==fa?[[U,X]]:[[W,V]]},perpendiculary:function(){var a=(S+Q)/2;if(2==fa&&J[0]==-1||3==fa&&1==J[0])return Math.abs(S-Q)>Math.max(f,g)?[[U,X]]:[[U,_],[W,_]];if(1==fa&&J[0]==-1||4==fa&&1==J[0]){var a=(S+Q)/2;return[[a,V],[a,X]]}return 1==fa&&1==J[0]||4==fa&&J[0]==-1?[[W,V]]:2==fa&&1==J[0]||3==fa&&J[0]==-1?Math.abs(T-R)>Math.max(f,g)?[[U,_],[W,_]]:[[W,V]]:void 0}},ja=ia[ea+da]();if(ja)for(var ka=0;ka<ja.length;ka++)u(ja[ka][0],ja[ka][1],Q,R,S,T);return u(W,X,Q,R,S,T),u(S,T,Q,R,S,T),t(),s(Q,R,S,T),p>n[3]&&(n[3]=p+2*z),o>n[2]&&(n[2]=o+2*z),n},this.pointOnPath=function(a,b){return d.pointAlongPathFrom(a,0,b)},this.gradientAtPoint=function(a,b){return j[v(a,b).index][4]},this.pointAlongPathFrom=function(a,b,c){var d=v(a,c),e=d.segment,f=d.proportion,g=j[d.index][5],h=j[d.index][4],i={x:h==1/0?e[2]:e[2]>e[0]?e[0]+(1-f)*g-b:e[2]+f*g+b,y:0==h?e[3]:e[3]>e[1]?e[1]+(1-f)*g-b:e[3]+f*g+b,segmentInfo:d};return i}},jsPlumb.Endpoints.Dot=function(a){this.type="Dot";var b=this;a=a||{},this.radius=a.radius||10,this.defaultOffset=.5*this.radius,this.defaultInnerRadius=this.radius/3,this.compute=function(a,c,d,e){var f=d.radius||b.radius,g=a[0]-f,h=a[1]-f;return[g,h,2*f,2*f,f]}},jsPlumb.Endpoints.Rectangle=function(a){this.type="Rectangle";var b=this;a=a||{},this.width=a.width||20,this.height=a.height||20,this.compute=function(a,c,d,e){var f=d.width||b.width,g=d.height||b.height,h=a[0]-f/2,i=a[1]-g/2;return[h,i,f,g]}};var a=function(a){jsPlumb.DOMElementComponent.apply(this,arguments);var b=[];this.getDisplayElements=function(){return b},this.appendDisplayElement=function(a){b.push(a)}};jsPlumb.Endpoints.Image=function(b){this.type="Image",a.apply(this,arguments);var c=this,d=!1,e=!1,f=b.width,g=b.height,h=null,i=b.endpoint;this.img=new Image,c.ready=!1,this.img.onload=function(){c.ready=!0,f=f||c.img.width,g=g||c.img.height,h&&h(c)},i.setImage=function(a,b){a.constructor==String?a:a.src;h=b,c.img.src=a,null!=c.canvas&&c.canvas.setAttribute("src",a)},i.setImage(b.src||b.url,b.onload),this.compute=function(a,b,d,e){return c.anchorPoint=a,c.ready?[a[0]-f/2,a[1]-g/2,f,g]:[0,0,0,0]},c.canvas=document.createElement("img"),d=!1,c.canvas.style.margin=0,c.canvas.style.padding=0,c.canvas.style.outline=0,c.canvas.style.position="absolute";var j=b.cssClass?" "+b.cssClass:"";c.canvas.className=jsPlumb.endpointClass+j,f&&c.canvas.setAttribute("width",f),g&&c.canvas.setAttribute("height",g),jsPlumb.appendElement(c.canvas,b.parent),c.attachListeners(c.canvas,c),c.cleanup=function(){e=!0};var k=function(a,b,h){if(!e){d||(c.canvas.setAttribute("src",c.img.src),c.appendDisplayElement(c.canvas),d=!0);var i=c.anchorPoint[0]-f/2,j=c.anchorPoint[1]-g/2;jsPlumb.sizeCanvas(c.canvas,i,j,f,g)}};this.paint=function(a,b,d){c.ready?k(a,b,d):window.setTimeout(function(){c.paint(a,b,d)},200)}},jsPlumb.Endpoints.Blank=function(b){var c=this;this.type="Blank",a.apply(this,arguments),this.compute=function(a,b,c,d){return[a[0],a[1],10,0]},c.canvas=document.createElement("div"),c.canvas.style.display="block",c.canvas.style.width="1px",c.canvas.style.height="1px",c.canvas.style.background="transparent",c.canvas.style.position="absolute",c.canvas.className=c._jsPlumb.endpointClass,jsPlumb.appendElement(c.canvas,b.parent),this.paint=function(a,b,d){jsPlumb.sizeCanvas(c.canvas,a[0],a[1],a[2],a[3])}},jsPlumb.Endpoints.Triangle=function(a){this.type="Triangle",a=a||{},a.width=a.width||55,a.height=a.height||55,this.width=a.width,this.height=a.height,this.compute=function(a,b,c,d){var e=c.width||self.width,f=c.height||self.height,g=a[0]-e/2,h=a[1]-f/2;return[g,h,e,f]}};var b=function(a){var b=!0,c=this;this.isAppendedAtTopLevel=!0,this.component=a.component,this.loc=null==a.location?.5:a.location,this.endpointLoc=null==a.endpointLocation?[.5,.5]:a.endpointLocation,this.setVisible=function(a){b=a,c.component.repaint()},this.isVisible=function(){return b},this.hide=function(){c.setVisible(!1)},this.show=function(){c.setVisible(!0)},this.incrementLocation=function(a){c.loc+=a,c.component.repaint()},this.setLocation=function(a){c.loc=a,c.component.repaint()},this.getLocation=function(){return c.loc}};jsPlumb.Overlays.Arrow=function(a){this.type="Arrow",b.apply(this,arguments),this.isAppendedAtTopLevel=!1,a=a||{};var c=this;this.length=a.length||20,this.width=a.width||20,this.id=a.id;var d=(a.direction||1)<0?-1:1,e=a.paintStyle||{lineWidth:1},f=a.foldback||.623;this.computeMaxSize=function(){return 1.5*c.width},this.cleanup=function(){},this.draw=function(a,b,g){var h,i,j,k,l;if(a.pointAlongPathFrom){if(jsPlumbUtil.isString(c.loc)||c.loc>1||c.loc<0){var m=parseInt(c.loc);h=a.pointAlongPathFrom(m,d*c.length/2,!0),i=a.pointOnPath(m,!0),j=jsPlumbUtil.pointOnLine(h,i,c.length)}else if(1==c.loc){if(h=a.pointOnPath(c.loc),i=a.pointAlongPathFrom(c.loc,-1),j=jsPlumbUtil.pointOnLine(h,i,c.length),d==-1){var n=j;j=h,h=n}}else if(0==c.loc){if(j=a.pointOnPath(c.loc),i=a.pointAlongPathFrom(c.loc,1),h=jsPlumbUtil.pointOnLine(j,i,c.length),d==-1){var n=j;j=h,h=n}}else h=a.pointAlongPathFrom(c.loc,d*c.length/2),i=a.pointOnPath(c.loc),j=jsPlumbUtil.pointOnLine(h,i,c.length);k=jsPlumbUtil.perpendicularLineTo(h,j,c.width),l=jsPlumbUtil.pointOnLine(h,j,f*c.length);var o=Math.min(h.x,k[0].x,k[1].x),p=Math.max(h.x,k[0].x,k[1].x),q=Math.min(h.y,k[0].y,k[1].y),r=Math.max(h.y,k[0].y,k[1].y),s={hxy:h,tail:k,cxy:l},t=e.strokeStyle||b.strokeStyle,u=e.fillStyle||b.strokeStyle,v=e.lineWidth||b.lineWidth;return c.paint(a,s,v,t,u,g),[o,p,q,r]}return[0,0,0,0]}},jsPlumb.Overlays.PlainArrow=function(a){a=a||{};var b=jsPlumb.extend(a,{foldback:1});jsPlumb.Overlays.Arrow.call(this,b),this.type="PlainArrow"},jsPlumb.Overlays.Diamond=function(a){a=a||{};var b=a.length||40,c=jsPlumb.extend(a,{length:b/2,foldback:2});jsPlumb.Overlays.Arrow.call(this,c),this.type="Diamond"};var c=function(a){jsPlumb.DOMElementComponent.apply(this,arguments),b.apply(this,arguments);var c=this,d=!1;a=a||{},this.id=a.id;var e,f=function(){e=a.create(a.component),e=jsPlumb.CurrentLibrary.getDOMElement(e),e.style.position="absolute";var b=a._jsPlumb.overlayClass+" "+(c.cssClass?c.cssClass:a.cssClass?a.cssClass:"");e.className=b,jsPlumb.appendElement(e,a.component.parent),a._jsPlumb.getId(e),c.attachListeners(e,c),c.canvas=e};this.getElement=function(){return null==e&&f(),e},this.getDimensions=function(){return jsPlumb.CurrentLibrary.getSize(jsPlumb.CurrentLibrary.getElementObject(c.getElement()))};var g=null,h=function(a){return null==g&&(g=c.getDimensions()),g};this.clearCachedDimensions=function(){g=null},this.computeMaxSize=function(){var a=h();return Math.max(a[0],a[1])};var i=c.setVisible;c.setVisible=function(a){i(a),e.style.display=a?"block":"none"},this.cleanup=function(){null!=e&&jsPlumb.CurrentLibrary.removeElement(e)},this.paint=function(a,b,f){d||(c.getElement(),a.appendDisplayElement(e),c.attachListeners(e,a),d=!0),e.style.left=f[0]+b.minx+"px",e.style.top=f[1]+b.miny+"px"},this.draw=function(a,b,d){var e=h();if(null!=e&&2==e.length){var f={x:0,y:0};if(a.pointOnPath){var g=c.loc,i=!1;(jsPlumbUtil.isString(c.loc)||c.loc<0||c.loc>1)&&(g=parseInt(c.loc),i=!0),f=a.pointOnPath(g,i)}else{var j=c.loc.constructor==Array?c.loc:c.endpointLoc;f={x:j[0]*d[2],y:j[1]*d[3]}}return minx=f.x-e[0]/2,miny=f.y-e[1]/2,c.paint(a,{minx:minx,miny:miny,td:e,cxy:f},d),[minx,minx+e[0],miny,miny+e[1]]}return[0,0,0,0]},this.reattachListeners=function(a){e&&c.reattachListenersForElement(e,c,a)}};jsPlumb.Overlays.Custom=function(a){this.type="Custom",c.apply(this,arguments)},jsPlumb.Overlays.Label=function(a){var b=this;this.labelStyle=a.labelStyle||jsPlumb.Defaults.LabelStyle,this.cssClass=null!=this.labelStyle?this.labelStyle.cssClass:null,a.create=function(){return document.createElement("div")},jsPlumb.Overlays.Custom.apply(this,arguments),this.type="Label";var c=a.label||"",b=this,d=null;this.setLabel=function(a){c=a,d=null,b.clearCachedDimensions(),e(),b.component.repaint()};var e=function(){if("function"==typeof c){var a=c(b);b.getElement().innerHTML=a.replace(/\r\n/g,"<br/>")}else null==d&&(d=c,b.getElement().innerHTML=d.replace(/\r\n/g,"<br/>"))};this.getLabel=function(){return c};var f=this.getDimensions;this.getDimensions=function(){return e(),f()}}}(),function(){var a=function(a,b,c,d){return a<=c&&d<=b?1:a<=c&&b<=d?2:c<=a&&d>=b?3:4},b=function(a,b,c,d,e,f,g,h,i){return h<=i?[a,b]:1==c?d[3]<=0&&e[3]>=1?[a+(d[2]<.5?-1*f:f),b]:d[2]>=1&&e[2]<=0?[a,b+(d[3]<.5?-1*g:g)]:[a+-1*f,b+-1*g]:2==c?d[3]>=1&&e[3]<=0?[a+(d[2]<.5?-1*f:f),b]:d[2]>=1&&e[2]<=0?[a,b+(d[3]<.5?-1*g:g)]:[a+1*f,b+-1*g]:3==c?d[3]>=1&&e[3]<=0?[a+(d[2]<.5?-1*f:f),b]:d[2]<=0&&e[2]>=1?[a,b+(d[3]<.5?-1*g:g)]:[a+-1*f,b+-1*g]:4==c?d[3]<=0&&e[3]>=1?[a+(d[2]<.5?-1*f:f),b]:d[2]<=0&&e[2]>=1?[a,b+(d[3]<.5?-1*g:g)]:[a+1*f,b+-1*g]:void 0};jsPlumb.Connectors.StateMachine=function(c){var d,e,f,g,h=null,i=[],j=c.curviness||10,k=c.margin||5,l=c.proximityLimit||80,m=c.orientation&&"clockwise"==c.orientation,n=c.loopbackRadius||25,o=!1,p=c.showLoopback!==!1;this.type="StateMachine",c=c||{},this.compute=function(c,q,r,s,t,u,v,w){var x=Math.abs(c[0]-q[0]),y=Math.abs(c[1]-q[1]),z=.45*x,A=.45*y;x*=1.9,y*=1.9,v=v||1;var B=Math.min(c[0],q[0])-z,C=Math.min(c[1],q[1])-A;if(p&&r.elementId==s.elementId){o=!0;var D=c[0],E=c[0],F=c[1]-k,G=c[1]-k,H=D,I=F-n;x=2*v+4*n,y=2*v+4*n,B=H-n-v-n,C=I-n-v-n,h=[B,C,x,y,H-B,I-C,n,m,D-B,F-C,E-B,G-C]}else{o=!1,d=c[0]<q[0]?z:x-z,e=c[1]<q[1]?A:y-A,f=c[0]<q[0]?x-z:z,g=c[1]<q[1]?y-A:A,0==c[2]&&(d-=k),1==c[2]&&(d+=k),0==c[3]&&(e-=k),1==c[3]&&(e+=k),0==q[2]&&(f-=k),1==q[2]&&(f+=k),0==q[3]&&(g-=k),1==q[3]&&(g+=k);var J=(d+f)/2,K=(e+g)/2,L=-1*J/K,M=Math.atan(L),N=(L==1/0||L==-(1/0)?0:Math.abs(j/2*Math.sin(M)),L==1/0||L==-(1/0)?0:Math.abs(j/2*Math.cos(M)),a(d,e,f,g)),O=Math.sqrt(Math.pow(f-d,2)+Math.pow(g-e,2));i=b(J,K,N,c,q,j,j,O,l);var P=Math.max(3*Math.abs(i[0]-d),3*Math.abs(i[0]-f),Math.abs(f-d),2*v,w),Q=Math.max(3*Math.abs(i[1]-e),3*Math.abs(i[1]-g),Math.abs(g-e),2*v,w);if(x<P){var R=P-x;B-=R/2,d+=R/2,f+=R/2,x=P,i[0]+=R/2}if(y<Q){var S=Q-y;C-=S/2,e+=S/2,g+=S/2,y=Q,i[1]+=S/2}h=[B,C,x,y,d,e,f,g,i[0],i[1]]}return h};var q=function(){return[{x:f,y:g},{x:i[0],y:i[1]},{x:i[0]+1,y:i[1]+1},{x:d,y:e}]},r=function(a,b,c){return c&&(b=jsBezier.locationAlongCurveFrom(a,b>0?0:1,b)),b};this.pointOnPath=function(a,b){if(o){if(b){var c=2*Math.PI*n;a/=c}a>0&&a<1&&(a=1-a);var d=2*a*Math.PI+Math.PI/2,e=h[4]+h[6]*Math.cos(d),f=h[5]+h[6]*Math.sin(d);return{x:e,y:f}}var g=q();return a=r(g,a,b),jsBezier.pointOnCurve(g,a)},this.gradientAtPoint=function(a,b){if(o){if(b){var c=2*Math.PI*n;a/=c}return Math.atan(2*a*Math.PI)}var d=q();return a=r(d,a,b),jsBezier.gradientAtPoint(d,a)},this.pointAlongPathFrom=function(a,b,c){if(o){if(c){var d=2*Math.PI*n;a/=d}a>0&&a<1&&(a=1-a);var d=2*Math.PI*h[6],e=b/d*2*Math.PI,f=2*a*Math.PI-e+Math.PI/2,g=h[4]+h[6]*Math.cos(f),i=h[5]+h[6]*Math.sin(f);return{x:g,y:i}}var j=q();return a=r(j,a,c),jsBezier.pointAlongCurveFrom(j,a,b)}},jsPlumb.Connectors.canvas.StateMachine=function(a){a=a||{};var b=this;a.drawGuideline||!0,a.avoidSelector;jsPlumb.Connectors.StateMachine.apply(this,arguments),jsPlumb.CanvasConnector.apply(this,arguments),this._paint=function(a){if(10==a.length)b.ctx.beginPath(),b.ctx.moveTo(a[4],a[5]),b.ctx.bezierCurveTo(a[8],a[9],a[8],a[9],a[6],a[7]),b.ctx.stroke();else{b.ctx.save(),b.ctx.beginPath();var c=2*Math.PI,d=a[7];b.ctx.arc(a[4],a[5],a[6],0,c,d),b.ctx.stroke(),b.ctx.closePath(),b.ctx.restore()}},this.createGradient=function(a,b){return b.createLinearGradient(a[4],a[5],a[6],a[7])}},jsPlumb.Connectors.svg.StateMachine=function(){jsPlumb.Connectors.StateMachine.apply(this,arguments),jsPlumb.SvgConnector.apply(this,arguments),this.getPath=function(a){return 10==a.length?"M "+a[4]+" "+a[5]+" C "+a[8]+" "+a[9]+" "+a[8]+" "+a[9]+" "+a[6]+" "+a[7]:"M"+(a[8]+4)+" "+a[9]+" A "+a[6]+" "+a[6]+" 0 1,0 "+(a[8]-4)+" "+a[9]}},jsPlumb.Connectors.vml.StateMachine=function(){jsPlumb.Connectors.StateMachine.apply(this,arguments),jsPlumb.VmlConnector.apply(this,arguments);var a=jsPlumb.vml.convertValue;this.getPath=function(b){if(10==b.length)return"m"+a(b[4])+","+a(b[5])+" c"+a(b[8])+","+a(b[9])+","+a(b[8])+","+a(b[9])+","+a(b[6])+","+a(b[7])+" e";var c=a(b[8]-b[6]),d=a(b[9]-2*b[6]),e=c+a(2*b[6]),f=d+a(2*b[6]),g=c+","+d+","+e+","+f,h="ar "+g+","+a(b[8])+","+a(b[9])+","+a(b[8])+","+a(b[9])+" e";return h}}}(),function(){var a={"stroke-linejoin":"joinstyle",joinstyle:"joinstyle",endcap:"endcap",miterlimit:"miterlimit"},b=null;if(document.createStyleSheet&&document.namespaces){var c=[".jsplumb_vml","jsplumb\\:textbox","jsplumb\\:oval","jsplumb\\:rect","jsplumb\\:stroke","jsplumb\\:shape","jsplumb\\:group"],d="behavior:url(#default#VML);position:absolute;";b=document.createStyleSheet();for(var e=0;e<c.length;e++)b.addRule(c[e],d);document.namespaces.add("jsplumb","urn:schemas-microsoft-com:vml")}jsPlumb.vml={};var f=1e3,g=function(a,b){for(var c in b)a[c]=b[c]},h=function(a,b,c,d,e,f){c=c||{};var h=document.createElement("jsplumb:"+a);return f?e.appendElement(h,d):jsPlumb.CurrentLibrary.appendElement(h,d),h.className=(c.class?c.class+" ":"")+"jsplumb_vml",i(h,b),g(h,c),h},i=function(a,b,c){a.style.left=b[0]+"px",a.style.top=b[1]+"px",a.style.width=b[2]+"px",a.style.height=b[3]+"px",a.style.position="absolute",c&&(a.style.zIndex=c)},j=jsPlumb.vml.convertValue=function(a){return Math.floor(a*f)},k=function(a,b,c,d){"transparent"===b?d.setOpacity(c,"0.0"):d.setOpacity(c,"1.0")},l=function(a,b,c,d){var e={};if(b.strokeStyle){e.stroked="true";var f=jsPlumbUtil.convertStyle(b.strokeStyle,!0);e.strokecolor=f,k(e,f,"stroke",c),e.strokeweight=b.lineWidth+"px"}else e.stroked="false";if(b.fillStyle){e.filled="true";var i=jsPlumbUtil.convertStyle(b.fillStyle,!0);e.fillcolor=i,k(e,i,"fill",c)}else e.filled="false";if(b.dashstyle)null==c.strokeNode?c.strokeNode=h("stroke",[0,0,0,0],{dashstyle:b.dashstyle},a,d):c.strokeNode.dashstyle=b.dashstyle;else if(b["stroke-dasharray"]&&b.lineWidth){for(var j=b["stroke-dasharray"].indexOf(",")==-1?" ":",",l=b["stroke-dasharray"].split(j),m="",n=0;n<l.length;n++)m+=Math.floor(l[n]/b.lineWidth)+j;null==c.strokeNode?c.strokeNode=h("stroke",[0,0,0,0],{dashstyle:m},a,d):c.strokeNode.dashstyle=m}g(a,e)},m=function(){
var a=this;jsPlumb.jsPlumbUIComponent.apply(this,arguments),this.opacityNodes={stroke:null,fill:null},this.initOpacityNodes=function(b){a.opacityNodes.stroke=h("stroke",[0,0,1,1],{opacity:"0.0"},b,a._jsPlumb),a.opacityNodes.fill=h("fill",[0,0,1,1],{opacity:"0.0"},b,a._jsPlumb)},this.setOpacity=function(b,c){var d=a.opacityNodes[b];d&&(d.opacity=""+c)};var b=[];this.getDisplayElements=function(){return b},this.appendDisplayElement=function(c,d){d||a.canvas.parentNode.appendChild(c),b.push(c)}},n=jsPlumb.VmlConnector=function(b){var c=this;c.strokeNode=null,c.canvas=null,m.apply(this,arguments);var d=c._jsPlumb.connectorClass+(b.cssClass?" "+b.cssClass:"");this.paint=function(e,j,k){if(null!=j){var m=c.getPath(e),n={path:m};if(j.outlineColor){var o=j.outlineWidth||1,p=j.lineWidth+2*o,q={strokeStyle:jsPlumbUtil.convertStyle(j.outlineColor),lineWidth:p};for(var r in a)q[r]=j[r];null==c.bgCanvas?(n.class=d,n.coordsize=e[2]*f+","+e[3]*f,c.bgCanvas=h("shape",e,n,b.parent,c._jsPlumb,!0),i(c.bgCanvas,e,c.getZIndex()),c.appendDisplayElement(c.bgCanvas,!0),c.attachListeners(c.bgCanvas,c),c.initOpacityNodes(c.bgCanvas,["stroke"])):(n.coordsize=e[2]*f+","+e[3]*f,i(c.bgCanvas,e,c.getZIndex()),g(c.bgCanvas,n)),l(c.bgCanvas,q,c)}null==c.canvas?(n.class=d,n.coordsize=e[2]*f+","+e[3]*f,c.tooltip&&(n.label=c.tooltip),c.canvas=h("shape",e,n,b.parent,c._jsPlumb,!0),c.appendDisplayElement(c.canvas,!0),c.attachListeners(c.canvas,c),c.initOpacityNodes(c.canvas,["stroke"])):(n.coordsize=e[2]*f+","+e[3]*f,i(c.canvas,e,c.getZIndex()),g(c.canvas,n)),l(c.canvas,j,c,c._jsPlumb)}},this.reattachListeners=function(){c.canvas&&c.reattachListenersForElement(c.canvas,c)}},o=window.VmlEndpoint=function(a){m.apply(this,arguments);var b=null,c=this;c.canvas=document.createElement("div"),c.canvas.style.position="absolute";var d=c._jsPlumb.endpointClass+(a.cssClass?" "+a.cssClass:"");a._jsPlumb.appendElement(c.canvas,a.parent),c.tooltip&&c.canvas.setAttribute("label",c.tooltip),this.paint=function(a,e,f){var h={};jsPlumb.sizeCanvas(c.canvas,a[0],a[1],a[2],a[3]),null==b?(h.class=d,b=c.getVml([0,0,a[2],a[3]],h,f,c.canvas,c._jsPlumb),c.attachListeners(b,c),c.appendDisplayElement(b,!0),c.appendDisplayElement(c.canvas,!0),c.initOpacityNodes(b,["fill"])):(i(b,[0,0,a[2],a[3]]),g(b,h)),l(b,e,c)},this.reattachListeners=function(){b&&c.reattachListenersForElement(b,c)}};jsPlumb.Connectors.vml.Bezier=function(){jsPlumb.Connectors.Bezier.apply(this,arguments),n.apply(this,arguments),this.getPath=function(a){return"m"+j(a[4])+","+j(a[5])+" c"+j(a[8])+","+j(a[9])+","+j(a[10])+","+j(a[11])+","+j(a[6])+","+j(a[7])+" e"}},jsPlumb.Connectors.vml.Straight=function(){jsPlumb.Connectors.Straight.apply(this,arguments),n.apply(this,arguments),this.getPath=function(a){return"m"+j(a[4])+","+j(a[5])+" l"+j(a[6])+","+j(a[7])+" e"}},jsPlumb.Connectors.vml.Flowchart=function(){jsPlumb.Connectors.Flowchart.apply(this,arguments),n.apply(this,arguments),this.getPath=function(a){for(var b="m "+j(a[4])+","+j(a[5])+" l",c=0;c<a[8];c++)b=b+" "+j(a[9+2*c])+","+j(a[10+2*c]);return b=b+" "+j(a[6])+","+j(a[7])+" e"}},jsPlumb.Endpoints.vml.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments),o.apply(this,arguments),this.getVml=function(a,b,c,d,e){return h("oval",a,b,d,e)}},jsPlumb.Endpoints.vml.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments),o.apply(this,arguments),this.getVml=function(a,b,c,d,e){return h("rect",a,b,d,e)}},jsPlumb.Endpoints.vml.Image=jsPlumb.Endpoints.Image,jsPlumb.Endpoints.vml.Blank=jsPlumb.Endpoints.Blank,jsPlumb.Overlays.vml.Label=jsPlumb.Overlays.Label,jsPlumb.Overlays.vml.Custom=jsPlumb.Overlays.Custom;var p=function(a,b){a.apply(this,b),m.apply(this,b);var c=this;c.canvas=null,c.isAppendedAtTopLevel=!0;var d=function(a,b){return"m "+j(a.hxy.x)+","+j(a.hxy.y)+" l "+j(a.tail[0].x)+","+j(a.tail[0].y)+" "+j(a.cxy.x)+","+j(a.cxy.y)+" "+j(a.tail[1].x)+","+j(a.tail[1].y)+" x e"};this.paint=function(a,b,e,j,k,l){var m={};j&&(m.stroked="true",m.strokecolor=jsPlumbUtil.convertStyle(j,!0)),e&&(m.strokeweight=e+"px"),k&&(m.filled="true",m.fillcolor=k);var n=Math.min(b.hxy.x,b.tail[0].x,b.tail[1].x,b.cxy.x),o=Math.min(b.hxy.y,b.tail[0].y,b.tail[1].y,b.cxy.y),p=Math.max(b.hxy.x,b.tail[0].x,b.tail[1].x,b.cxy.x),q=Math.max(b.hxy.y,b.tail[0].y,b.tail[1].y,b.cxy.y),r=Math.abs(p-n),s=Math.abs(q-o),t=[n,o,r,s];m.path=d(b,l),m.coordsize=l[2]*f+","+l[3]*f,t[0]=l[0],t[1]=l[1],t[2]=l[2],t[3]=l[3],null==c.canvas?(c.canvas=h("shape",t,m,a.canvas.parentNode,a._jsPlumb,!0),a.appendDisplayElement(c.canvas,!0),c.attachListeners(c.canvas,a),c.attachListeners(c.canvas,c)):(i(c.canvas,t),g(c.canvas,m))},this.reattachListeners=function(){c.canvas&&c.reattachListenersForElement(c.canvas,c)},this.cleanup=function(){null!=c.canvas&&jsPlumb.CurrentLibrary.removeElement(c.canvas)}};jsPlumb.Overlays.vml.Arrow=function(){p.apply(this,[jsPlumb.Overlays.Arrow,arguments])},jsPlumb.Overlays.vml.PlainArrow=function(){p.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])},jsPlumb.Overlays.vml.Diamond=function(){p.apply(this,[jsPlumb.Overlays.Diamond,arguments])}}(),function(){var a={joinstyle:"stroke-linejoin","stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},b="stroke-dasharray",c="dashstyle",d="linearGradient",e="radialGradient",f="fill",g="stop",h="stroke",i="stroke-width",j="style",k="none",l="jsplumb_gradient_",m="lineWidth",n={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml"},o=function(a,b){for(var c in b)a.setAttribute(c,""+b[c])},p=function(a,b){var c=document.createElementNS(n.svg,a);return b=b||{},b.version="1.1",b.xmlns=n.xhtml,o(c,b),c},q=function(a){return"position:absolute;left:"+a[0]+"px;top:"+a[1]+"px"},r=function(a){for(var b=0;b<a.childNodes.length;b++)a.childNodes[b].tagName!=d&&a.childNodes[b].tagName!=e||a.removeChild(a.childNodes[b])},s=function(a,b,c,i,k){var m=l+k._jsPlumb.idstamp();if(r(a),c.gradient.offset){var n=p(e,{id:m});a.appendChild(n)}else{var n=p(d,{id:m,gradientUnits:"userSpaceOnUse"});a.appendChild(n)}for(var o=0;o<c.gradient.stops.length;o++){var q=o;q=8==i.length?i[4]<i[6]?o:c.gradient.stops.length-1-o:i[4]<i[6]?c.gradient.stops.length-1-o:o;var s=jsPlumbUtil.convertStyle(c.gradient.stops[q][1],!0),t=p(g,{offset:Math.floor(100*c.gradient.stops[o][0])+"%","stop-color":s});n.appendChild(t)}var u=c.strokeStyle?h:f;b.setAttribute(j,u+":url(#"+m+")")},t=function(d,e,g,l,n){if(g.gradient?s(d,e,g,l,n):(r(d),e.setAttribute(j,"")),e.setAttribute(f,g.fillStyle?jsPlumbUtil.convertStyle(g.fillStyle,!0):k),e.setAttribute(h,g.strokeStyle?jsPlumbUtil.convertStyle(g.strokeStyle,!0):k),g.lineWidth&&e.setAttribute(i,g.lineWidth),g[c]&&g[m]&&!g[b]){var o=g[c].indexOf(",")==-1?" ":",",p=g[c].split(o),q="";p.forEach(function(a){q+=Math.floor(a*g.lineWidth)+o}),e.setAttribute(b,q)}else g[b]&&e.setAttribute(b,g[b]);for(var t in a)g[t]&&e.setAttribute(a[t],g[t])},u=function(a,b,c){for(var d=c.split(" "),e=a.className,f=e.baseVal.split(" "),g=0;g<d.length;g++)if(b)f.indexOf(d[g])==-1&&f.push(d[g]);else{var h=f.indexOf(d[g]);h!=-1&&f.splice(h,1)}a.className.baseVal=f.join(" ")},v=function(a,b){u(a,!0,b)},w=function(a,b){u(a,!1,b)};jsPlumbUtil.svg={addClass:v,removeClass:w,node:p,attr:o,pos:q};var x=function(a){var b=this,c=a.pointerEventsSpec||"all";jsPlumb.jsPlumbUIComponent.apply(this,a.originalArgs),b.canvas=null,b.path=null,b.svg=null;var d=a.cssClass+" "+(a.originalArgs[0].cssClass||""),e={style:"",width:0,height:0,"pointer-events":c,position:"absolute"};b.tooltip&&(e.title=b.tooltip),b.svg=p("svg",e),a.useDivWrapper?(b.canvas=document.createElement("div"),b.canvas.style.position="absolute",jsPlumb.sizeCanvas(b.canvas,0,0,1,1),b.canvas.className=d,b.tooltip&&b.canvas.setAttribute("title",b.tooltip)):(o(b.svg,{class:d}),b.canvas=b.svg),a._jsPlumb.appendElement(b.canvas,a.originalArgs[0].parent),a.useDivWrapper&&b.canvas.appendChild(b.svg);var f=[b.canvas];this.getDisplayElements=function(){return f},this.appendDisplayElement=function(a){f.push(a)},this.paint=function(c,d,e){if(null!=d){var f=c[0],g=c[1];a.useDivWrapper&&(jsPlumb.sizeCanvas(b.canvas,c[0],c[1],c[2],c[3]),f=0,g=0);var h=q([f,g,c[2],c[3]]);b.getZIndex()&&(h+=";z-index:"+b.getZIndex()+";"),o(b.svg,{style:h,width:c[2],height:c[3]}),b._paint.apply(this,arguments)}}},y=jsPlumb.SvgConnector=function(a){var b=this;x.apply(this,[{cssClass:a._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",tooltip:a.tooltip,_jsPlumb:a._jsPlumb}]),this._paint=function(a,c){var d=b.getPath(a),e={d:d},f=null;if(e["pointer-events"]="all",c.outlineColor){var g=c.outlineWidth||1,h=c.lineWidth+2*g,f=jsPlumb.CurrentLibrary.extend({},c);f.strokeStyle=jsPlumbUtil.convertStyle(c.outlineColor),f.lineWidth=h,null==b.bgPath?(b.bgPath=p("path",e),b.svg.appendChild(b.bgPath),b.attachListeners(b.bgPath,b)):o(b.bgPath,e),t(b.svg,b.bgPath,f,a,b)}null==b.path?(b.path=p("path",e),b.svg.appendChild(b.path),b.attachListeners(b.path,b)):o(b.path,e),t(b.svg,b.path,c,a,b)},this.reattachListeners=function(){b.bgPath&&b.reattachListenersForElement(b.bgPath,b),b.path&&b.reattachListenersForElement(b.path,b)}};jsPlumb.Connectors.svg.Bezier=function(a){jsPlumb.Connectors.Bezier.apply(this,arguments),y.apply(this,arguments),this.getPath=function(a){var b="M "+a[4]+" "+a[5];return b+=" C "+a[8]+" "+a[9]+" "+a[10]+" "+a[11]+" "+a[6]+" "+a[7]}},jsPlumb.Connectors.svg.Straight=function(a){jsPlumb.Connectors.Straight.apply(this,arguments),y.apply(this,arguments),this.getPath=function(a){return"M "+a[4]+" "+a[5]+" L "+a[6]+" "+a[7]}},jsPlumb.Connectors.svg.Flowchart=function(){var a=this;jsPlumb.Connectors.Flowchart.apply(this,arguments),y.apply(this,arguments),this.getPath=function(b){for(var c="M "+b[4]+","+b[5],d=b[4],e=b[5],f=0;f<b[8];f++){var g=b[9+2*f],h=b[10+2*f],i=b[9+2*(f+1)],j=b[10+2*(f+1)],k=g!=d&&h==e,l=g==d&&h!=e,m=k?g>i?1:-1:0,n=l?h>j?1:-1:0,o=a.lineWidth/2;c=c+" L "+g+" "+h,c=c+" L "+(g+m*o)+" "+(h+n*o),d=g,e=h,c=c+" M "+g+" "+h}return c=c+" L "+b[6]+","+b[7]}};var z=window.SvgEndpoint=function(a){var b=this;x.apply(this,[{cssClass:a._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:!0,_jsPlumb:a._jsPlumb}]),this._paint=function(a,c){var d=jsPlumb.extend({},c);d.outlineColor&&(d.strokeWidth=d.outlineWidth,d.strokeStyle=jsPlumbUtil.convertStyle(d.outlineColor,!0)),null==b.node&&(b.node=b.makeNode(a,d),b.svg.appendChild(b.node),b.attachListeners(b.node,b)),t(b.svg,b.node,d,a,b),q(b.node,a)},this.reattachListeners=function(){b.node&&b.reattachListenersForElement(b.node,b)}};jsPlumb.Endpoints.svg.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments),z.apply(this,arguments),this.makeNode=function(a,b){return p("circle",{cx:a[2]/2,cy:a[3]/2,r:a[2]/2})}},jsPlumb.Endpoints.svg.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments),z.apply(this,arguments),this.makeNode=function(a,b){return p("rect",{width:a[2],height:a[3]})}},jsPlumb.Endpoints.svg.Image=jsPlumb.Endpoints.Image,jsPlumb.Endpoints.svg.Blank=jsPlumb.Endpoints.Blank,jsPlumb.Overlays.svg.Label=jsPlumb.Overlays.Label,jsPlumb.Overlays.svg.Custom=jsPlumb.Overlays.Custom;var A=function(a,b){a.apply(this,b),jsPlumb.jsPlumbUIComponent.apply(this,b),this.isAppendedAtTopLevel=!1;var c=this,d=null;this.paint=function(a,f,g,h,i){null==d&&(d=p("path",{"pointer-events":"all"}),a.svg.appendChild(d),c.attachListeners(d,a),c.attachListeners(d,c));var j=b&&1==b.length?b[0].cssClass||"":"";o(d,{d:e(f),class:j,stroke:h?h:null,fill:i?i:null})};var e=function(a){return"M"+a.hxy.x+","+a.hxy.y+" L"+a.tail[0].x+","+a.tail[0].y+" L"+a.cxy.x+","+a.cxy.y+" L"+a.tail[1].x+","+a.tail[1].y+" L"+a.hxy.x+","+a.hxy.y};this.reattachListeners=function(){d&&c.reattachListenersForElement(d,c)},this.cleanup=function(){null!=d&&jsPlumb.CurrentLibrary.removeElement(d)}};jsPlumb.Overlays.svg.Arrow=function(){A.apply(this,[jsPlumb.Overlays.Arrow,arguments])},jsPlumb.Overlays.svg.PlainArrow=function(){A.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])},jsPlumb.Overlays.svg.Diamond=function(){A.apply(this,[jsPlumb.Overlays.Diamond,arguments])},jsPlumb.Overlays.svg.GuideLines=function(){var a,b,c=null,d=this;jsPlumb.Overlays.GuideLines.apply(this,arguments),this.paint=function(f,g,h,i,j){null==c&&(c=p("path"),f.svg.appendChild(c),d.attachListeners(c,f),d.attachListeners(c,d),a=p("path"),f.svg.appendChild(a),d.attachListeners(a,f),d.attachListeners(a,d),b=p("path"),f.svg.appendChild(b),d.attachListeners(b,f),d.attachListeners(b,d)),o(c,{d:e(g[0],g[1]),stroke:"red",fill:null}),o(a,{d:e(g[2][0],g[2][1]),stroke:"blue",fill:null}),o(b,{d:e(g[3][0],g[3][1]),stroke:"green",fill:null})};var e=function(a,b){return"M "+a.x+","+a.y+" L"+b.x+","+b.y}}}(),function(){var a=null,b=function(a,b){return jsPlumb.CurrentLibrary.hasClass(c(a),b)},c=function(a){return jsPlumb.CurrentLibrary.getElementObject(a)},d=function(a){return jsPlumb.CurrentLibrary.getOffset(c(a))},e=function(a){return jsPlumb.CurrentLibrary.getPageXY(a)},f=function(a){return jsPlumb.CurrentLibrary.getClientXY(a)},g=function(){var g=this;g.overlayPlacements=[],jsPlumb.jsPlumbUIComponent.apply(this,arguments),jsPlumbUtil.EventGenerator.apply(this,arguments),this._over=function(a){var b=d(c(g.canvas)),f=e(a),h=f[0]-b.left,i=f[1]-b.top;if(h>0&&i>0&&h<g.canvas.width&&i<g.canvas.height){for(var j=0;j<g.overlayPlacements.length;j++){var k=g.overlayPlacements[j];if(k&&k[0]<=h&&k[1]>=h&&k[2]<=i&&k[3]>=i)return!0}var l=g.canvas.getContext("2d").getImageData(parseInt(h),parseInt(i),1,1);return 0!=l.data[0]||0!=l.data[1]||0!=l.data[2]||0!=l.data[3]}return!1};var h=!1,i=!1,j=null,k=!1,l=function(a,c){return null!=a&&b(a,c)};this.mousemove=function(b){var c=(e(b),f(b)),d=document.elementFromPoint(c[0],c[1]),i=l(d,"_jsPlumb_overlay"),j=null==a&&(l(d,"_jsPlumb_endpoint")||l(d,"_jsPlumb_connector"));return!h&&j&&g._over(b)?(h=!0,g.fire("mouseenter",g,b),!0):(!h||g._over(b)&&j||i||(h=!1,g.fire("mouseexit",g,b)),void g.fire("mousemove",g,b))},this.click=function(a){h&&g._over(a)&&!k&&g.fire("click",g,a),k=!1},this.dblclick=function(a){h&&g._over(a)&&!k&&g.fire("dblclick",g,a),k=!1},this.mousedown=function(a){g._over(a)&&!i&&(i=!0,j=d(c(g.canvas)),g.fire("mousedown",g,a))},this.mouseup=function(a){i=!1,g.fire("mouseup",g,a)},this.contextmenu=function(a){h&&g._over(a)&&!k&&g.fire("contextmenu",g,a),k=!1}},h=function(a){var b=document.createElement("canvas");return a._jsPlumb.appendElement(b,a.parent),b.style.position="absolute",a.class&&(b.className=a.class),a._jsPlumb.getId(b,a.uuid),a.tooltip&&b.setAttribute("title",a.tooltip),b},i=function(a){g.apply(this,arguments);var b=[];this.getDisplayElements=function(){return b},this.appendDisplayElement=function(a){b.push(a)}},j=jsPlumb.CanvasConnector=function(a){i.apply(this,arguments);var b=function(a,b){if(c.ctx.save(),jsPlumb.extend(c.ctx,b),b.gradient){for(var d=c.createGradient(a,c.ctx),e=0;e<b.gradient.stops.length;e++)d.addColorStop(b.gradient.stops[e][0],b.gradient.stops[e][1]);c.ctx.strokeStyle=d}c._paint(a,b),c.ctx.restore()},c=this,d=c._jsPlumb.connectorClass+" "+(a.cssClass||"");c.canvas=h({class:d,_jsPlumb:c._jsPlumb,parent:a.parent,tooltip:a.tooltip}),c.ctx=c.canvas.getContext("2d"),c.appendDisplayElement(c.canvas),c.paint=function(a,d){if(null!=d){if(jsPlumb.sizeCanvas(c.canvas,a[0],a[1],a[2],a[3]),c.getZIndex()&&(c.canvas.style.zIndex=c.getZIndex()),null!=d.outlineColor){var e=d.outlineWidth||1,f=d.lineWidth+2*e,g={strokeStyle:d.outlineColor,lineWidth:f};b(a,g)}b(a,d)}}},k=function(a){var b=this;i.apply(this,arguments);var c=b._jsPlumb.endpointClass+" "+(a.cssClass||""),d={class:c,_jsPlumb:b._jsPlumb,parent:a.parent,tooltip:b.tooltip};b.canvas=h(d),b.ctx=b.canvas.getContext("2d"),b.appendDisplayElement(b.canvas),this.paint=function(a,c,d){if(jsPlumb.sizeCanvas(b.canvas,a[0],a[1],a[2],a[3]),null!=c.outlineColor){var e=c.outlineWidth||1,f=c.lineWidth+2*e;({strokeStyle:c.outlineColor,lineWidth:f})}b._paint.apply(this,arguments)}};jsPlumb.Endpoints.canvas.Dot=function(a){jsPlumb.Endpoints.Dot.apply(this,arguments),k.apply(this,arguments);var b=this,c=function(a){try{return parseInt(a)}catch(b){if("%"==a.substring(a.length-1))return parseInt(a.substring(0,a-1))}},d=function(a){var d=b.defaultOffset,e=b.defaultInnerRadius;return a.offset&&(d=c(a.offset)),a.innerRadius&&(e=c(a.innerRadius)),[d,e]};this._paint=function(a,c,e){if(null!=c){var f=b.canvas.getContext("2d"),g=e.getOrientation(b);if(jsPlumb.extend(f,c),c.gradient){for(var h=d(c.gradient),i=1==g[1]?h[0]*-1:h[0],j=1==g[0]?h[0]*-1:h[0],k=f.createRadialGradient(a[4],a[4],a[4],a[4]+j,a[4]+i,h[1]),l=0;l<c.gradient.stops.length;l++)k.addColorStop(c.gradient.stops[l][0],c.gradient.stops[l][1]);f.fillStyle=k}f.beginPath(),f.arc(a[4],a[4],a[4],0,2*Math.PI,!0),f.closePath(),(c.fillStyle||c.gradient)&&f.fill(),c.strokeStyle&&f.stroke()}}},jsPlumb.Endpoints.canvas.Rectangle=function(a){var b=this;jsPlumb.Endpoints.Rectangle.apply(this,arguments),k.apply(this,arguments),this._paint=function(a,c,d){var e=b.canvas.getContext("2d"),f=d.getOrientation(b);if(jsPlumb.extend(e,c),c.gradient){for(var g=1==f[1]?a[3]:0==f[1]?a[3]/2:0,h=f[1]==-1?a[3]:0==f[1]?a[3]/2:0,i=1==f[0]?a[2]:0==f[0]?a[2]/2:0,j=f[0]==-1?a[2]:0==f[0]?a[2]/2:0,k=e.createLinearGradient(i,g,j,h),l=0;l<c.gradient.stops.length;l++)k.addColorStop(c.gradient.stops[l][0],c.gradient.stops[l][1]);e.fillStyle=k}e.beginPath(),e.rect(0,0,a[2],a[3]),e.closePath(),(c.fillStyle||c.gradient)&&e.fill(),c.strokeStyle&&e.stroke()}},jsPlumb.Endpoints.canvas.Triangle=function(a){var b=this;jsPlumb.Endpoints.Triangle.apply(this,arguments),k.apply(this,arguments),this._paint=function(a,c,d){var e=a[2],f=a[3],g=(a[0],a[1],b.canvas.getContext("2d")),h=0,i=0,j=0,k=d.getOrientation(b);1==k[0]&&(h=e,i=f,j=180),k[1]==-1&&(h=e,j=90),1==k[1]&&(i=f,j=-90),g.fillStyle=c.fillStyle,g.translate(h,i),g.rotate(j*Math.PI/180),g.beginPath(),g.moveTo(0,0),g.lineTo(e/2,f/2),g.lineTo(0,f),g.closePath(),(c.fillStyle||c.gradient)&&g.fill(),c.strokeStyle&&g.stroke()}},jsPlumb.Endpoints.canvas.Image=jsPlumb.Endpoints.Image,jsPlumb.Endpoints.canvas.Blank=jsPlumb.Endpoints.Blank,jsPlumb.Connectors.canvas.Bezier=function(){var a=this;jsPlumb.Connectors.Bezier.apply(this,arguments),j.apply(this,arguments),this._paint=function(b,c){a.ctx.beginPath(),a.ctx.moveTo(b[4],b[5]),a.ctx.bezierCurveTo(b[8],b[9],b[10],b[11],b[6],b[7]),a.ctx.stroke()},this.createGradient=function(b,c,d){return a.ctx.createLinearGradient(b[6],b[7],b[4],b[5])}},jsPlumb.Connectors.canvas.Straight=function(){var a=this,b=[null,[1,-1],[1,1],[-1,1],[-1,-1]];jsPlumb.Connectors.Straight.apply(this,arguments),j.apply(this,arguments),this._paint=function(c,d){if(a.ctx.beginPath(),d.dashstyle&&2==d.dashstyle.split(" ").length){var e=d.dashstyle.split(" ");2!=e.length&&(e=[2,2]);for(var f=[e[0]*d.lineWidth,e[1]*d.lineWidth],g=(c[6]-c[4])/(c[7]-c[5]),h=jsPlumbUtil.segment([c[4],c[5]],[c[6],c[7]]),i=b[h],j=Math.atan(g),k=Math.sqrt(Math.pow(c[6]-c[4],2)+Math.pow(c[7]-c[5],2)),l=Math.floor(k/(f[0]+f[1])),m=[c[4],c[5]],n=0;n<l;n++){a.ctx.moveTo(m[0],m[1]);var o=m[0]+Math.abs(Math.sin(j)*f[0])*i[0],p=m[1]+Math.abs(Math.cos(j)*f[0])*i[1],q=m[0]+Math.abs(Math.sin(j)*(f[0]+f[1]))*i[0],r=m[1]+Math.abs(Math.cos(j)*(f[0]+f[1]))*i[1];a.ctx.lineTo(o,p),m=[q,r]}a.ctx.moveTo(m[0],m[1]),a.ctx.lineTo(c[6],c[7])}else a.ctx.moveTo(c[4],c[5]),a.ctx.lineTo(c[6],c[7]);a.ctx.stroke()},this.createGradient=function(a,b){return b.createLinearGradient(a[4],a[5],a[6],a[7])}},jsPlumb.Connectors.canvas.Flowchart=function(){var a=this;jsPlumb.Connectors.Flowchart.apply(this,arguments),j.apply(this,arguments),this._paint=function(b,c){a.ctx.beginPath(),a.ctx.moveTo(b[4],b[5]);for(var d=0;d<b[8];d++)a.ctx.lineTo(b[9+2*d],b[10+2*d]);a.ctx.lineTo(b[6],b[7]),a.ctx.stroke()},this.createGradient=function(a,b){return b.createLinearGradient(a[4],a[5],a[6],a[7])}},jsPlumb.Overlays.canvas.Label=jsPlumb.Overlays.Label,jsPlumb.Overlays.canvas.Custom=jsPlumb.Overlays.Custom;var l=function(){jsPlumb.jsPlumbUIComponent.apply(this,arguments)},m=function(a,b){a.apply(this,b),l.apply(this,b),this.paint=function(a,b,c,d,e){var f=a.ctx;f.lineWidth=c,f.beginPath(),f.moveTo(b.hxy.x,b.hxy.y),f.lineTo(b.tail[0].x,b.tail[0].y),f.lineTo(b.cxy.x,b.cxy.y),f.lineTo(b.tail[1].x,b.tail[1].y),f.lineTo(b.hxy.x,b.hxy.y),f.closePath(),d&&(f.strokeStyle=d,f.stroke()),e&&(f.fillStyle=e,f.fill())}};jsPlumb.Overlays.canvas.Arrow=function(){m.apply(this,[jsPlumb.Overlays.Arrow,arguments])},jsPlumb.Overlays.canvas.PlainArrow=function(){m.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])},jsPlumb.Overlays.canvas.Diamond=function(){m.apply(this,[jsPlumb.Overlays.Diamond,arguments])}}(),function(a){jsPlumb.CurrentLibrary={addClass:function(a,b){a=jsPlumb.CurrentLibrary.getElementObject(a);try{a[0].className.constructor==SVGAnimatedString&&jsPlumbUtil.svg.addClass(a[0],b)}catch(a){}a.addClass(b)},animate:function(a,b,c){a.animate(b,c)},appendElement:function(a,b){jsPlumb.CurrentLibrary.getElementObject(b).append(a)},ajax:function(b){b=b||{},b.type=b.type||"get",a.ajax(b)},bind:function(a,b,c){a=jsPlumb.CurrentLibrary.getElementObject(a),a.bind(b,c)},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete"},extend:function(b,c){return a.extend(b,c)},getAttribute:function(a,b){return a.attr(b)},getClientXY:function(a){return[a.clientX,a.clientY]},getDragObject:function(a){return a[1].draggable},getDragScope:function(a){return a.draggable("option","scope")},getDropEvent:function(a){return a[0]},getDropScope:function(a){return a.droppable("option","scope")},getDOMElement:function(a){return"string"==typeof a?document.getElementById(a):a.context||null!=a.length?a[0]:a},getElementObject:function(b){return a("string"==typeof b?"#"+b:b)},getOffset:function(a){return a.offset()},getOriginalEvent:function(a){return a.originalEvent},getPageXY:function(a){return[a.pageX,a.pageY]},getParent:function(a){return jsPlumb.CurrentLibrary.getElementObject(a).parent()},getScrollLeft:function(a){return a.scrollLeft()},getScrollTop:function(a){return a.scrollTop()},getSelector:function(b){return a(b)},getSize:function(a){return[a.outerWidth(),a.outerHeight()]},getTagName:function(a){var b=jsPlumb.CurrentLibrary.getElementObject(a);return b.length>0?b[0].tagName:null},getUIPosition:function(a,b){if(b=b||1,1==a.length)ret={left:a[0].pageX,top:a[0].pageY};else{var c=a[1],d=c.offset;ret=d||c.absolutePosition,c.position.left/=b,c.position.top/=b}return{left:ret.left/b,top:ret.top/b}},hasClass:function(a,b){return a.hasClass(b)},initDraggable:function(a,b,c){b=b||{},b.helper=null,c&&(b.scope=b.scope||jsPlumb.Defaults.Scope),a.draggable(b)},initDroppable:function(a,b){b.scope=b.scope||jsPlumb.Defaults.Scope,a.droppable(b)},isAlreadyDraggable:function(a){return a=jsPlumb.CurrentLibrary.getElementObject(a),a.hasClass("ui-draggable")},isDragSupported:function(a,b){return a.draggable},isDropSupported:function(a,b){return a.droppable},removeClass:function(a,b){a=jsPlumb.CurrentLibrary.getElementObject(a);try{a[0].className.constructor==SVGAnimatedString&&jsPlumbUtil.svg.removeClass(a[0],b)}catch(a){}a.removeClass(b)},removeElement:function(a,b){jsPlumb.CurrentLibrary.getElementObject(a).remove()},setAttribute:function(a,b,c){a.attr(b,c)},setDraggable:function(a,b){a.draggable("option","disabled",!b)},setDragScope:function(a,b){a.draggable("option","scope",b)},setOffset:function(a,b){jsPlumb.CurrentLibrary.getElementObject(a).offset(b)},trigger:function(a,b,c){var d=jQuery._data(jsPlumb.CurrentLibrary.getElementObject(a)[0],"handle");d(c)},unbind:function(a,b,c){a=jsPlumb.CurrentLibrary.getElementObject(a),a.unbind(b,c)}},a(document).ready(jsPlumb.init)}(jQuery),function(){"undefined"==typeof Math.sgn&&(Math.sgn=function(a){return 0==a?0:0<a?1:-1});var a={subtract:function(a,b){return{x:a.x-b.x,y:a.y-b.y}},dotProduct:function(a,b){return a.x*b.x+a.y*b.y},square:function(a){return Math.sqrt(a.x*a.x+a.y*a.y)},scale:function(a,b){return{x:a.x*b,y:a.y*b}}},b=Math.pow(2,-65),c=function(b,c){for(var f=[],g=c.length-1,h=2*g-1,i=[],k=[],l=[],m=[],n=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],o=0;o<=g;o++)i[o]=a.subtract(c[o],b);for(o=0;o<=g-1;o++)k[o]=a.subtract(c[o+1],c[o]),k[o]=a.scale(k[o],3);for(o=0;o<=g-1;o++)for(var p=0;p<=g;p++)l[o]||(l[o]=[]),l[o][p]=a.dotProduct(k[o],i[p]);for(o=0;o<=h;o++)m[o]||(m[o]=[]),m[o].y=0,m[o].x=parseFloat(o)/h;for(h=g-1,i=0;i<=g+h;i++)for(o=Math.max(0,i-h),k=Math.min(i,g);o<=k;o++)j=i-o,m[o+j].y=m[o+j].y+l[j][o]*n[j][o];for(g=c.length-1,m=d(m,2*g-1,f,0),h=a.subtract(b,c[0]),l=a.square(h),o=n=0;o<m;o++)h=a.subtract(b,e(c,g,f[o],null,null)),h=a.square(h),h<l&&(l=h,n=f[o]);return h=a.subtract(b,c[g]),h=a.square(h),h<l&&(l=h,n=1),{location:n,distance:l}},d=function(a,c,f,g){var h,i,j=[],k=[],l=[],m=[],n=0;i=Math.sgn(a[0].y);for(var o=1;o<=c;o++)h=Math.sgn(a[o].y),h!=i&&n++,i=h;switch(n){case 0:return 0;case 1:if(g>=64)return f[0]=(a[0].x+a[c].x)/2,1;var p,n=a[0].y-a[c].y;for(i=a[c].x-a[0].x,o=a[0].x*a[c].y-a[c].x*a[0].y,h=max_distance_below=0,p=1;p<c;p++){var q=n*a[p].x+i*a[p].y+o;q>h?h=q:q<max_distance_below&&(max_distance_below=q)}if(p=i,h=(1*(o-h)-0*p)*(1/(0*p-1*n)),p=i,i=o-max_distance_below,n=(1*i-0*p)*(1/(0*p-1*n)),i=Math.min(h,n),Math.max(h,n)-i<b)return l=a[c].x-a[0].x,m=a[c].y-a[0].y,f[0]=0+1*(l*(a[0].y-0)-m*(a[0].x-0))*(1/(0*l-1*m)),1}for(e(a,c,.5,j,k),a=d(j,c,l,g+1),c=d(k,c,m,g+1),g=0;g<a;g++)f[g]=l[g];for(g=0;g<c;g++)f[g+a]=m[g];return a+c},e=function(a,b,c,d,e){for(var f=[[]],g=0;g<=b;g++)f[0][g]=a[g];for(a=1;a<=b;a++)for(g=0;g<=b-a;g++)f[a]||(f[a]=[]),f[a][g]||(f[a][g]={}),f[a][g].x=(1-c)*f[a-1][g].x+c*f[a-1][g+1].x,f[a][g].y=(1-c)*f[a-1][g].y+c*f[a-1][g+1].y;if(null!=d)for(g=0;g<=b;g++)d[g]=f[g][0];if(null!=e)for(g=0;g<=b;g++)e[g]=f[b-g][g];return f[b][0]},f={},g=function(a){var b=f[a];if(!b){var b=[],c=function(a){return function(){return a}},d=function(){return function(a){return a}},e=function(){return function(a){return 1-a}},g=function(a){return function(b){for(var c=1,d=0;d<a.length;d++)c*=a[d](b);return c}};b.push(new function(){return function(b){return Math.pow(b,a)}});for(var h=1;h<a;h++){for(var i=[new c(a)],j=0;j<a-h;j++)i.push(new d);for(j=0;j<h;j++)i.push(new e);b.push(new g(i))}b.push(new function(){return function(b){return Math.pow(1-b,a)}}),f[a]=b}return b},h=function(a,b){for(var c=g(a.length-1),d=0,e=0,f=0;f<a.length;f++)d+=a[f].x*c[f](b),e+=a[f].y*c[f](b);return{x:d,y:e}},i=function(a,b,c){for(var d=h(a,b),e=0,f=c>0?1:-1,g=null;e<Math.abs(c);)b+=.005*f,g=h(a,b),e+=Math.sqrt(Math.pow(g.x-d.x,2)+Math.pow(g.y-d.y,2)),d=g;return{point:g,location:b}},k=function(a,b){var c=h(a,b),d=h(a.slice(0,a.length-1),b),e=d.y-c.y,c=d.x-c.x;return 0==e?1/0:Math.atan(e/c)};window.jsBezier={distanceFromCurve:c,gradientAtPoint:k,gradientAtPointAlongCurveFrom:function(a,b,c){return b=i(a,b,c),b.location>1&&(b.location=1),b.location<0&&(b.location=0),k(a,b.location)},nearestPointOnCurve:function(a,b){var d=c(a,b);return{point:e(b,b.length-1,d.location,null,null),location:d.location}},pointOnCurve:h,pointAlongCurveFrom:function(a,b,c){return i(a,b,c).point},perpendicularToCurveAt:function(a,b,c,d){return b=i(a,b,null==d?0:d),a=k(a,b.location),d=Math.atan(-1/a),a=c/2*Math.sin(d),c=c/2*Math.cos(d),[{x:b.point.x+c,y:b.point.y+a},{x:b.point.x-c,y:b.point.y-a}]},locationAlongCurveFrom:function(a,b,c){return i(a,b,c).location}}}();